<pre><font color="#007f69">extensions</font><font color="#000000"> [palette matrix nw table]<br /><br /></font><font color="#007f69">globals</font><font color="#000000"> [ soil-csv-header-written? species tree-set mate N Ni Nt1 Nt2 Nt3 Nt4 Nt5 Nt6 Nt7 Nt8 Nt9 Nt counter current-tick<br /><br />          nearest-neighbor-threshold second-neighbor-threshold<br />          start? harvesting trimming fertilizing  soil-factor<br />          growth-rate-ilex  growth-rate-cana  growth-rate-an  growth-rate-la  growth-rate-pet  growth-rate-ar  growth-rate-gu<br />          growth-rate-toona  growth-rate-gr  growth-rate-ki<br />          growth-energy-uptake<br />          harvest-size         </font><font color="#5a5a5a">; Minimum size for harvesting</font><font color="#000000"><br />          tree-trim-size       </font><font color="#5a5a5a">; Minimum size for trimming</font><font color="#000000"><br />          tree-thin-size       </font><font color="#5a5a5a">; Minimum size for thinning</font><font color="#000000"><br />          harvest-rate         </font><font color="#5a5a5a">; Percentage of plant harvested</font><font color="#000000"><br />          harvest-amount       </font><font color="#5a5a5a">; Amount ilex plants are reduced as harvest</font><font color="#000000"><br />          total-harvest        </font><font color="#5a5a5a">; Total amount harvested over time</font><font color="#000000"><br />          minimum-viable-size  </font><font color="#5a5a5a">; Minimum size for a plant to be manipulated</font><font color="#000000"><br />          harvest-trees        </font><font color="#5a5a5a">; Amount trees are reduced as trimming which is a harvest</font><font color="#000000"><br />          thinned-amount       </font><font color="#5a5a5a">; Amount of tree mass reduced by thinning</font><font color="#000000"><br />          et soil-multiplier-mate soil-multiplier-trees species-multipliers  soil-multiplier-increment convert-dry convert-SOM buffer-factor fertilizer-amount<br />  thiniter1?  thiniter2? thinned-count soil-multiplier soil-gain countert1 last-rebalance  previous-soil-energy soil-energy-improvement]<br /><br /></font><font color="#660096">breed</font><font color="#000000"> [ species0 ilex ]             </font><font color="#5a5a5a">; ilex</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species1 Toona ]            </font><font color="#5a5a5a">; Toona</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species2 Cana ]             </font><font color="#5a5a5a">; Cañafístola</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species3 La ]               </font><font color="#5a5a5a">; Lapacho</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species4 Pet ]              </font><font color="#5a5a5a">; Petiribí</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species5 An ]               </font><font color="#5a5a5a">; Anchico</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species6 Ar ]               </font><font color="#5a5a5a">; Araucaria</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species7 Gu]                </font><font color="#5a5a5a">; Guatambú</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species8 Gr ]               </font><font color="#5a5a5a">; Grevillea</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species9 Ki ]               </font><font color="#5a5a5a">; Kiri</font><font color="#000000"><br /><br /></font><font color="#007f69">species0-own</font><font color="#000000"> [ energy-ilex harvested-amount]<br /></font><font color="#007f69">species1-own</font><font color="#000000"> [ energy-Toona       soil-multiplier-Toona]<br /></font><font color="#007f69">species2-own</font><font color="#000000"> [ energy-Cañafístola soil-multiplier-Cañafístola]<br /></font><font color="#007f69">species3-own</font><font color="#000000"> [ energy-Lapacho     soil-multiplier-Lapacho]<br /></font><font color="#007f69">species4-own</font><font color="#000000"> [ energy-Petiribí    soil-multiplier-Petiribí]<br /></font><font color="#007f69">species5-own</font><font color="#000000"> [ energy-Anchico     soil-multiplier-Anchico]<br /></font><font color="#007f69">species6-own</font><font color="#000000"> [ energy-Araucaria   soil-multiplier-Araucaria]<br /></font><font color="#007f69">species7-own</font><font color="#000000"> [ energy-Guatambú    soil-multiplier-Guatambú]<br /></font><font color="#007f69">species8-own</font><font color="#000000"> [ energy-Grevillea   soil-multiplier-Grevillea]<br /></font><font color="#007f69">species9-own</font><font color="#000000"> [ energy-Kiri        soil-multiplier-Kiri]<br /></font><font color="#007f69">turtles-own</font><font color="#000000">  [ energy-trees ]<br /></font><font color="#007f69">patches-own</font><font color="#000000">  [ soil soil-energy  soil1 soil2 soil3 soil4 soil5 local-soil-factor]<br /></font><font color="#007f69">links-own</font><font color="#000000"> [ weight link-interaction-type<br />            weight-distance<br />            weight-shade<br />            weight-soil<br />            weight-combined<br />            neighbor-order  </font><font color="#5a5a5a">; 1 for first neighbors, 2 for second neighbors</font><font color="#000000"><br />]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">resize-world</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">210</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">210</font><font color="#000000"><br />  </font><font color="#0000aa">set-patch-size</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> tree-set []                                                 </font><font color="#5a5a5a">;; List of all trees</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> mate  []                                                    </font><font color="#5a5a5a">;; List of all ilex plants</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> species []                                                  </font><font color="#5a5a5a">;; List of all plants, ilex &amp; trees</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> start? </font><font color="#963700">true</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thiniter1? </font><font color="#963700">true</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thiniter2? </font><font color="#963700">false</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thinned-count </font><font color="#963700">0</font><font color="#000000"><br /><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvesting   [</font><font color="#963700">24</font><font color="#000000"> </font><font color="#963700">76</font><font color="#000000"> </font><font color="#963700">128</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"> </font><font color="#963700">232</font><font color="#000000"> </font><font color="#963700">284</font><font color="#000000"> </font><font color="#963700">336</font><font color="#000000"> </font><font color="#963700">388</font><font color="#000000"> </font><font color="#963700">440</font><font color="#000000"> </font><font color="#963700">492</font><font color="#000000"> </font><font color="#963700">544</font><font color="#000000">]    </font><font color="#5a5a5a">;; For efficiency, lists are given not computed; Harvest June 24</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> fertilizing  [</font><font color="#963700">40</font><font color="#000000"> </font><font color="#963700">92</font><font color="#000000"> </font><font color="#963700">144</font><font color="#000000"> </font><font color="#963700">196</font><font color="#000000"> </font><font color="#963700">248</font><font color="#000000"> </font><font color="#963700">300</font><font color="#000000"> </font><font color="#963700">352</font><font color="#000000"> </font><font color="#963700">404</font><font color="#000000"> </font><font color="#963700">456</font><font color="#000000"> </font><font color="#963700">508</font><font color="#000000"> </font><font color="#963700">560</font><font color="#000000">]    </font><font color="#5a5a5a">;; Fertilizing October 40</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> trimming     [</font><font color="#963700">36</font><font color="#000000"> </font><font color="#963700">88</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000"> </font><font color="#963700">192</font><font color="#000000"> </font><font color="#963700">244</font><font color="#000000"> </font><font color="#963700">296</font><font color="#000000"> </font><font color="#963700">348</font><font color="#000000"> </font><font color="#963700">400</font><font color="#000000"> </font><font color="#963700">452</font><font color="#000000"> </font><font color="#963700">504</font><font color="#000000"> </font><font color="#963700">556</font><font color="#000000">]    </font><font color="#5a5a5a">;; Trimming trees from September year 1 36</font><font color="#000000"><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">  [<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil fertility                                              </font><font color="#5a5a5a">;; the terrain (patches) variable soil takes the value of the chosen soil fertility starting point</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">10000</font><font color="#000000">                     </font><font color="#5a5a5a">;; colors represent the starting soil fertility, chosen by the user, which is stored in soil types 1 to 5</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">49</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil1 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">39</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil2 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">29</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil3 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">19</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil4 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000">  [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">  </font><font color="#963700">139</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil5 fertility ]<br />   ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-ilex  </font><font color="#963700">0.22</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-toona </font><font color="#963700">0.64</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-cana  </font><font color="#963700">0.33</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-la    </font><font color="#963700">0.49</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-pet   </font><font color="#963700">0.44</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-an    </font><font color="#963700">0.32</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-ar    </font><font color="#963700">0.25</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-gu    </font><font color="#963700">0.56</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-gr    </font><font color="#963700">0.35</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-pet   </font><font color="#963700">0.44</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-ki    </font><font color="#963700">0.54</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#963700">7.5</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> second-neighbor-threshold  </font><font color="#963700">16.5</font><font color="#000000"><br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> species-names [</font><font color="#963700">&quot;Toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Cañafístola&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Lapacho&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Petiribí&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Anchico&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Araucaria&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Guatambú&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Grevillea&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Kiri&quot;</font><font color="#000000">]<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [  </font><font color="#5a5a5a">; Skip species0 (ilex)</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> breed-name (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> i)<br />      </font><font color="#0000aa">let</font><font color="#000000"> species-name </font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) species-names<br />      </font><font color="#0000aa">ask</font><font color="#000000"> (</font><font color="#660096">turtle-set</font><font color="#000000"> </font><font color="#660096">runresult</font><font color="#000000"> breed-name) [<br />        </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set soil-multiplier-&quot;</font><font color="#000000"> species-name </font><font color="#963700">&quot; 0.05&quot;</font><font color="#000000">)  </font><font color="#5a5a5a">; Small initial value</font><font color="#000000"><br />      ]<br />    ]<br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-energy-uptake </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-mate </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> species-multipliers table:make<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-increment </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-energy-improvement </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> convert-dry  </font><font color="#963700">0.12</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> convert-SOM  </font><font color="#963700">0.3</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> buffer-factor </font><font color="#963700">0.12</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> fertilizer-amount </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-gain </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> countert1 </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> last-rebalance </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> previous-soil-energy </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-size </font><font color="#963700">2.5</font><font color="#000000">                                            </font><font color="#5a5a5a">;; only harvest plants size 2.5 or larger</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> tree-trim-size </font><font color="#963700">3.2</font><font color="#000000">                                          </font><font color="#5a5a5a">;; only trim trees size 3.2 or larger</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> tree-thin-size </font><font color="#963700">9</font><font color="#000000">                                            </font><font color="#5a5a5a">;; only thin trees size 9 or larger</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-rate harvest-intensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">                        </font><font color="#5a5a5a">;; Harvest 34% of the plant</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-harvest </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-amount []<br />  </font><font color="#0000aa">set</font><font color="#000000"> minimum-viable-size </font><font color="#963700">0.25</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-trees </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thinned-amount </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor </font><font color="#963700">1</font><font color="#000000"> ]<br /><br />  </font><font color="#0000aa">let</font><font color="#000000">  n1 </font><font color="#963700">0</font><font color="#000000">                                                       </font><font color="#5a5a5a">;; create the initial array of Species0, ilex plants, mate</font><font color="#000000"><br />   </font><font color="#0000aa">while</font><font color="#000000"> [ n1 </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">]<br />         [</font><font color="#0000aa">let</font><font color="#000000"> n2 </font><font color="#963700">0</font><font color="#000000"><br />          </font><font color="#0000aa">while</font><font color="#000000"> [n2 </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">]<br />            [</font><font color="#0000aa">let</font><font color="#000000"> x n1 </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />             </font><font color="#0000aa">let</font><font color="#000000"> y n2 </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />             create-species0  </font><font color="#963700">1</font><font color="#000000"> [<br />                </font><font color="#0000aa">setxy</font><font color="#000000">  x  y<br />                </font><font color="#0000aa">set</font><font color="#000000"> mate </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> mate<br />                </font><font color="#0000aa">set</font><font color="#000000"> species </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species<br />              ]<br />         </font><font color="#0000aa">set</font><font color="#000000"> n2 n2 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />           ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> n1 n1 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />         ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;plant&quot;</font><font color="#000000">]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">66</font><font color="#000000">]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">]<br />    </font><font color="#0000aa">set</font><font color="#000000"> Ni  </font><font color="#660096">count</font><font color="#000000"> species0                                        </font><font color="#5a5a5a">;; Ni is the counter for the number of mate plants, number ilex</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;number ilex&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">show</font><font color="#000000"> Ni<br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;list ilex plants&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">show</font><font color="#000000"> mate<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> species-data [                                              </font><font color="#5a5a5a">;; each species will be placed at a determined x and y offsetset coordinates, with a color</font><font color="#000000"><br />    [</font><font color="#963700">&quot;species1&quot;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">    </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">53</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species2&quot;</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">55</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species3&quot;</font><font color="#000000"> </font><font color="#963700">40</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">57</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species4&quot;</font><font color="#000000"> </font><font color="#963700">60</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">63</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species5&quot;</font><font color="#000000"> </font><font color="#963700">80</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">67</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species6&quot;</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">43</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species7&quot;</font><font color="#000000"> </font><font color="#963700">120</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species8&quot;</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">77</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species9&quot;</font><font color="#000000"> </font><font color="#963700">160</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">74</font><font color="#000000">]<br />  ]<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> species-data [ data -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> breed-name </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> data<br />    </font><font color="#0000aa">let</font><font color="#000000"> start-x </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> data<br />    </font><font color="#0000aa">let</font><font color="#000000"> start-y </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> data<br />    </font><font color="#0000aa">let</font><font color="#000000"> colour  </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> data<br />    create-species breed-name start-x start-y colour<br />    create-species breed-name (start-x </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) start-y colour<br />  ]<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set Nt&quot;</font><font color="#000000"> i </font><font color="#963700">&quot; count species&quot;</font><font color="#000000"> (i))<br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> Nt (Nt1 </font><font color="#660096">+</font><font color="#000000"> Nt2 </font><font color="#660096">+</font><font color="#000000"> Nt3 </font><font color="#660096">+</font><font color="#000000"> Nt4 </font><font color="#660096">+</font><font color="#000000"> Nt5 </font><font color="#660096">+</font><font color="#000000"> Nt6 </font><font color="#660096">+</font><font color="#000000"> Nt7 </font><font color="#660096">+</font><font color="#000000"> Nt8 </font><font color="#660096">+</font><font color="#000000"> Nt9)    </font><font color="#5a5a5a">;; Nt is the counter for the number of all trees of all species</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;number trees&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">show</font><font color="#000000"> Nt<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;list tree set&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">show</font><font color="#000000"> tree-set<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;list of species&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">show</font><font color="#000000"> species<br />  </font><font color="#0000aa">if</font><font color="#000000"> idlabel?  [idLabel]<br />  initialize-soil-monitoring<br /><br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> create-species [breed-name start-x start-y colour]<br />  </font><font color="#0000aa">let</font><font color="#000000"> coordinates (</font><font color="#660096">n-values</font><font color="#000000"> </font><font color="#963700">21</font><font color="#000000"> [i -&gt; </font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> (</font><font color="#963700">5</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> i </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)])<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> coordinates [ xy -&gt;<br />    </font><font color="#0000aa">create-turtles</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">runresult</font><font color="#000000"> breed-name<br />      </font><font color="#0000aa">setxy</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> xy </font><font color="#660096">+</font><font color="#000000"> start-x) (</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> xy </font><font color="#660096">+</font><font color="#000000"> start-y)<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;tree&quot;</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> colour<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> tree-set </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> tree-set<br />      </font><font color="#0000aa">set</font><font color="#000000"> species </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> get-species [k]<br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> k)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> get-growth-rate [k]<br />  </font><font color="#0000aa">let</font><font color="#000000"> species-names [</font><font color="#963700">&quot;ilex&quot;</font><font color="#000000"> </font><font color="#963700">&quot;toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;cana&quot;</font><font color="#000000"> </font><font color="#963700">&quot;la&quot;</font><font color="#000000"> </font><font color="#963700">&quot;pet&quot;</font><font color="#000000"> </font><font color="#963700">&quot;an&quot;</font><font color="#000000"> </font><font color="#963700">&quot;ar&quot;</font><font color="#000000"> </font><font color="#963700">&quot;gu&quot;</font><font color="#000000"> </font><font color="#963700">&quot;gr&quot;</font><font color="#000000"> </font><font color="#963700">&quot;ki&quot;</font><font color="#000000">]<br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;growth-rate-&quot;</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> k species-names))<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />    time-account<br /><br />    </font><font color="#0000aa">if</font><font color="#000000"> w-network?  [create-weighted-network]<br />    </font><font color="#0000aa">if</font><font color="#000000"> multi-network?  [create-multi-interaction-network]<br />    </font><font color="#0000aa">if</font><font color="#000000"> w-matrix? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">   [ export-weighted-matrix-with-time  ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> w-matrix_xy? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">   [ export-weighted-matrix-with-coordinates ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> current-tick </font><font color="#660096">ticks</font><font color="#000000"><br /><br />    nodeData<br />    linkData<br />    set-soil-factor<br />    energy-account<br /><br />    </font><font color="#0000aa">if</font><font color="#000000">  </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">16</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [grow]<br />    </font><font color="#0000aa">if</font><font color="#000000">  </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [rebalance-soil]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;\nSoil Multiplier Status:&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> soil-multiplier-sources<br />    ]<br /><br />    </font><font color="#0000aa">foreach</font><font color="#000000"> harvesting  [ x -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> x [harvest-ilex-nearest-neighbors]]<br />    </font><font color="#0000aa">foreach</font><font color="#000000"> harvesting  [ x -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> x [harvest-ilex]]<br /><br />    </font><font color="#0000aa">foreach</font><font color="#000000"> fertilizing  [ x -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> x [fertilize]]<br />    </font><font color="#0000aa">foreach</font><font color="#000000"> trimming    [ x -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> x [trim-trees]]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000">] [thinning1]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> countert1 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">78</font><font color="#000000"> [thinning2]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">16</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [compete-shade]<br />    </font><font color="#0000aa">if</font><font color="#000000">  </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [decay-local-soil-factor]<br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [die-ilex]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species1 [die-tree]<br />    </font><font color="#0000aa">tick</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">521</font><font color="#000000"> [ </font><font color="#0000aa">stop</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> time-account<br />  </font><font color="#0000aa">set</font><font color="#000000"> counter counter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> idLabel<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> create-network                                                          </font><font color="#5a5a5a">;; Define lists for species breeds and their corresponding link colors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br />  </font><font color="#0000aa">let</font><font color="#000000"> colors-list (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">53</font><font color="#000000"> </font><font color="#963700">55</font><font color="#000000"> </font><font color="#963700">57</font><font color="#000000"> </font><font color="#963700">63</font><font color="#000000"> </font><font color="#963700">67</font><font color="#000000"> </font><font color="#963700">43</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000"> </font><font color="#963700">77</font><font color="#000000"> </font><font color="#963700">74</font><font color="#000000">)                        </font><font color="#5a5a5a">;; Corresponding colors for links</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-colors (</font><font color="#660096">map</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> tree-list colors-list)                         </font><font color="#5a5a5a">;; Combine species and colors into pairs</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> tree-colors [ pair -&gt;<br />      </font><font color="#0000aa">let</font><font color="#000000"> sp </font><font color="#660096">first</font><font color="#000000"> pair<br />      </font><font color="#0000aa">let</font><font color="#000000"> colour </font><font color="#660096">last</font><font color="#000000"> pair<br />      </font><font color="#0000aa">ask</font><font color="#000000"> species0 [                                                       </font><font color="#5a5a5a">;; Find the minimum distance to any turtle of the current species</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> min-dist </font><font color="#660096">min</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> sp                             </font><font color="#5a5a5a">;; Find all turtles of the current species at this minimum distance</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> closest-tree sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> min-dist]                </font><font color="#5a5a5a">;; Create a link with the closest turtles if within threshold distance</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> closest-tree [<br />        </font><font color="#0000aa">if</font><font color="#000000"> min-dist </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">7.1</font><font color="#000000"> [<br />          </font><font color="#0000aa">create-link-with</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> [<br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> colour<br />                     ]<br />                 ]<br />             ]<br />         ]<br />     ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> test-neighbors-1<br />  </font><font color="#5a5a5a">; Clear any existing links</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> [ </font><font color="#0000aa">die</font><font color="#000000"> ]<br />  </font><font color="#5a5a5a">; Define lists for species breeds and their corresponding link colors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br />  </font><font color="#5a5a5a">; Loop through each tree species</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> tree-list [ sp -&gt;<br />    </font><font color="#5a5a5a">; For each ilex plant</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />      </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br />      </font><font color="#5a5a5a">; Find first neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> first-neighbors sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;=</font><font color="#000000"> nearest-neighbor-threshold]<br />      </font><font color="#5a5a5a">; Create just distance links for first neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> first-neighbors [<br />        </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />          </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type </font><font color="#963700">&quot;distance-1-test&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;1st-test&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">1</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000"><br />        ]<br />      ]<br />    ]<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Test links 1st created: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance-1-test&quot;</font><font color="#000000">])<br /></font><font color="#007f69">end</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> test-neighbors-2<br />  </font><font color="#5a5a5a">; Clear any existing links</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> [ </font><font color="#0000aa">die</font><font color="#000000"> ]<br />  </font><font color="#5a5a5a">; Define lists for species breeds and their corresponding link colors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br />  </font><font color="#5a5a5a">; Loop through each tree species</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> tree-list [ sp -&gt;<br />    </font><font color="#5a5a5a">; For each ilex plant</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />      </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br />      </font><font color="#5a5a5a">; Find second neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> second-neighbors sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&gt;</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />                                    </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;</font><font color="#000000"> second-neighbor-threshold]<br />      </font><font color="#5a5a5a">; Create just distance links for second neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> second-neighbors [<br />        </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />          </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type </font><font color="#963700">&quot;distance-2-test&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;2nd-test&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">0.5</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.1</font><font color="#000000"><br />        ]<br />      ]<br />    ]<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Test links 2nd created: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance-2-test&quot;</font><font color="#000000">])<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; Add this to your code to check distance distributions</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> check-neighbor-distances<br />  </font><font color="#0000aa">let</font><font color="#000000"> first-neighbors </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> second-neighbors </font><font color="#963700">0</font><font color="#000000"><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> first-neighbors first-neighbors </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [<br />      </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"><br />      </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;=</font><font color="#000000"> nearest-neighbor-threshold<br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> second-neighbors second-neighbors </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [<br />      </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"><br />      </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&gt;</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />      </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;</font><font color="#000000"> second-neighbor-threshold<br />    ]<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total first neighbors: &quot;</font><font color="#000000"> first-neighbors)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total second neighbors: &quot;</font><font color="#000000"> second-neighbors)<br /><br />  </font><font color="#5a5a5a">; Sample a few specific distances for verification</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;\nSample distances:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;First neighbors:&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> (</font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;=</font><font color="#000000"> nearest-neighbor-threshold]) [<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Distance: &quot;</font><font color="#000000"> </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#963700">&quot;, Tree: &quot;</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">)<br />    ]<br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Second neighbors:&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> (</font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"><br />                                   </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&gt;</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />                                   </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;</font><font color="#000000"> second-neighbor-threshold]) [<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Distance: &quot;</font><font color="#000000"> </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#963700">&quot;, Tree: &quot;</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000">)<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> create-test-network-and-export<br />  </font><font color="#5a5a5a">; Network creation and Adjacency Matrix export</font><font color="#000000"><br />  </font><font color="#5a5a5a">; Clear any existing links</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> [ </font><font color="#0000aa">die</font><font color="#000000"> ]<br /><br />  </font><font color="#5a5a5a">; Define lists for species breeds and their corresponding link colors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br /><br />  </font><font color="#5a5a5a">; Loop through each tree species</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> tree-list [ sp -&gt;<br />    </font><font color="#5a5a5a">; For each ilex plant</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />      </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br /><br />      </font><font color="#5a5a5a">; Find first neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> first-neighbors sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;=</font><font color="#000000"> nearest-neighbor-threshold]<br /><br />      </font><font color="#5a5a5a">; Create distance links for first neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> first-neighbors [<br />        </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />          </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type </font><font color="#963700">&quot;distance-1-test&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000">  </font><font color="#5a5a5a">; Changed to &quot;1st&quot; for consistency with matrix export</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">1</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000"><br />        ]<br />      ]<br /><br />      </font><font color="#5a5a5a">; Find second neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> second-neighbors sp </font><font color="#660096">with</font><font color="#000000"> [<br />        </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&gt;</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />        </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;</font><font color="#000000"> second-neighbor-threshold<br />      ]<br /><br />      </font><font color="#5a5a5a">; Create distance links for second neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> second-neighbors [<br />        </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />          </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type </font><font color="#963700">&quot;distance-2-test&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000">  </font><font color="#5a5a5a">; Changed to &quot;2nd&quot; for consistency with matrix export</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">0.5</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.1</font><font color="#000000"><br />        ]<br />      ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">; Report on created links</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Test links 1st created: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance-1-test&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Test links 2nd created: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance-2-test&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total links created: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br /><br />  </font><font color="#5a5a5a">; Now export the adjacency matrix</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> num-turtles </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> adjacency_matrix </font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#963700">0</font><font color="#000000">]]<br />  </font><font color="#0000aa">let</font><font color="#000000"> turtle-list </font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Create the adjacency matrix with different weights for 1st and 2nd neighbors</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> [<br />    </font><font color="#0000aa">let</font><font color="#000000"> source </font><font color="#660096">end1</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> target </font><font color="#660096">end2</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> source-index </font><font color="#660096">position</font><font color="#000000"> source turtle-list<br />    </font><font color="#0000aa">let</font><font color="#000000"> target-index </font><font color="#660096">position</font><font color="#000000"> target turtle-list<br /><br />    </font><font color="#5a5a5a">; Assign weight based on link label</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> matrix-weight </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000">) [</font><font color="#963700">1</font><font color="#000000">] [</font><font color="#963700">0.5</font><font color="#000000">]<br /><br />    </font><font color="#5a5a5a">; Update matrix in both directions (undirected graph)</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> adjacency_matrix </font><font color="#660096">replace-item</font><font color="#000000"> source-index adjacency_matrix<br />      (</font><font color="#660096">replace-item</font><font color="#000000"> target-index (</font><font color="#660096">item</font><font color="#000000"> source-index adjacency_matrix) matrix-weight)<br />    </font><font color="#0000aa">set</font><font color="#000000"> adjacency_matrix </font><font color="#660096">replace-item</font><font color="#000000"> target-index adjacency_matrix<br />      (</font><font color="#660096">replace-item</font><font color="#000000"> source-index (</font><font color="#660096">item</font><font color="#000000"> target-index adjacency_matrix) matrix-weight)<br />  ]<br /><br />  </font><font color="#5a5a5a">; Export the matrix to file</font><font color="#000000"><br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;adjacency_matrix.txt&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;# Adjacency matrix with 1 for first neighbors, 0.5 for second neighbors, 0 for no connection&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;# Matrix size: &quot;</font><font color="#000000"> num-turtles </font><font color="#963700">&quot; x &quot;</font><font color="#000000"> num-turtles)<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;# Total links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;# First neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;# Second neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000">])<br /><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> adjacency_matrix [<br />    row -&gt; </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> (</font><font color="#660096">sentence</font><font color="#000000"> row </font><font color="#963700">&quot; &quot;</font><font color="#000000">))<br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Also create a sparse matrix format which is more manageable</font><font color="#000000"><br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;adjacency_matrix_sparse.csv&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;source,target,weight,label&quot;</font><font color="#000000"><br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ source -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ target -&gt;<br />      </font><font color="#0000aa">let</font><font color="#000000"> current-weight </font><font color="#660096">item</font><font color="#000000"> j (</font><font color="#660096">item</font><font color="#000000"> i adjacency_matrix)<br />      </font><font color="#0000aa">if</font><font color="#000000"> current-weight </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />        </font><font color="#0000aa">let</font><font color="#000000"> label-text </font><font color="#660096">ifelse-value</font><font color="#000000"> (current-weight </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#963700">&quot;first&quot;</font><font color="#000000">] [</font><font color="#963700">&quot;second&quot;</font><font color="#000000">]<br />        </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> source </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> current-weight </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> label-text)<br />      ]<br />      </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Network creation and adjacency matrix export complete!&quot;</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> nodeData<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;nodes.csv&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> sorted-turtles </font><font color="#660096">sort-on</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> sorted-turtles [ x -&gt;<br />    </font><font color="#0000aa">ask</font><font color="#000000"> x [                                                                 </font><font color="#5a5a5a">;; Determine the turtle's species type</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> spType </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species0) [</font><font color="#963700">&quot;ilex&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species1) [</font><font color="#963700">&quot;Toona&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species2) [</font><font color="#963700">&quot;Cana&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species3) [</font><font color="#963700">&quot;La&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species4) [</font><font color="#963700">&quot;Pet&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species5) [</font><font color="#963700">&quot;An&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species6) [</font><font color="#963700">&quot;Ar&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species7) [</font><font color="#963700">&quot;Gu&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species8) [</font><font color="#963700">&quot;Gr&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species9) [</font><font color="#963700">&quot;Ki&quot;</font><font color="#000000">]<br />               )))))))))<br />    </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> spType)       ]              </font><font color="#5a5a5a">;; Print the turtle's data to the CSV file</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> linkData<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;links.csv&quot;</font><font color="#000000">                                                     </font><font color="#5a5a5a">;; Collect all links into a list, then sort by the who number of end1 and then end2</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> all-links [</font><font color="#660096">self</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> sorted-links </font><font color="#660096">sort</font><font color="#000000"> all-links<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> sorted-links [ x -&gt;                                               </font><font color="#5a5a5a">;; Ask each link in the sorted list to print its ends' who numbers</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> x [<br />      </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000">  </font><font color="#660096">end1</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000">  </font><font color="#660096">end2</font><font color="#000000">)<br />    ]<br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; Procedure to create weighted network with first and second neighbors</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> create-weighted-network<br />  </font><font color="#5a5a5a">; Clear any existing links before creating new ones</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> [ </font><font color="#0000aa">die</font><font color="#000000"> ]<br /><br />  </font><font color="#5a5a5a">; Define lists for species breeds and their corresponding link colors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br />  </font><font color="#0000aa">let</font><font color="#000000"> colors-list (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">53</font><font color="#000000"> </font><font color="#963700">55</font><font color="#000000"> </font><font color="#963700">57</font><font color="#000000"> </font><font color="#963700">63</font><font color="#000000"> </font><font color="#963700">67</font><font color="#000000"> </font><font color="#963700">43</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000"> </font><font color="#963700">77</font><font color="#000000"> </font><font color="#963700">74</font><font color="#000000">)<br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-colors (</font><font color="#660096">map</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> tree-list colors-list)<br /><br />  </font><font color="#5a5a5a">; Interaction types to consider for weighting</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> selected-type interaction-type </font><font color="#5a5a5a">; This would be a global variable or interface control</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Loop through each tree species</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> tree-colors [ pair -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> sp </font><font color="#660096">first</font><font color="#000000"> pair<br />    </font><font color="#0000aa">let</font><font color="#000000"> colour </font><font color="#660096">last</font><font color="#000000"> pair<br /><br />    </font><font color="#5a5a5a">; For each ilex plant</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />      </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br /><br />      </font><font color="#5a5a5a">; Process first neighbors</font><font color="#000000"><br />      </font><font color="#5a5a5a">; Find the closest tree of this species</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> min-dist </font><font color="#660096">min</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant] </font><font color="#660096">of</font><font color="#000000"> sp<br />      </font><font color="#0000aa">let</font><font color="#000000"> closest-tree sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;=</font><font color="#000000"> (min-dist)]<br /><br />      </font><font color="#5a5a5a">; Only create links if within threshold distance</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> closest-tree [<br />        </font><font color="#0000aa">let</font><font color="#000000"> this-tree </font><font color="#660096">self</font><font color="#000000">  </font><font color="#5a5a5a">; Store the tree agent for reference</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> min-dist </font><font color="#660096">&lt;</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"> draw-w-network? [<br />          </font><font color="#5a5a5a">; Create first-neighbor link</font><font color="#000000"><br />          </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> colour<br />            </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type (</font><font color="#660096">word</font><font color="#000000"> selected-type </font><font color="#963700">&quot;-1&quot;</font><font color="#000000">) </font><font color="#5a5a5a">; Add &quot;-1&quot; to indicate first neighbor</font><font color="#000000"><br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000"><br /><br />             </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;no-interaction&quot;</font><font color="#000000"> [<br />              </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">0</font><font color="#000000"><br />              </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />            ][<br />            </font><font color="#5a5a5a">; Calculate weight based on interaction type (for first neighbors)</font><font color="#000000"><br />            </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance&quot;</font><font color="#000000"> [<br />              </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">1</font><font color="#000000"><br />              </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />            ][<br />              </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;shade&quot;</font><font color="#000000"> [<br />                </font><font color="#0000aa">set</font><font color="#000000"> weight (</font><font color="#660096">-</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000">) </font><font color="#5a5a5a">; Use this-tree instead of self</font><font color="#000000"><br />                </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />              ][<br />                </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;soil&quot;</font><font color="#000000"> [<br />                  </font><font color="#0000aa">let</font><font color="#000000"> soil-mult </font><font color="#963700">0</font><font color="#000000"><br /><br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Toona] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Lapacho] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Petiribí] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Anchico] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Araucaria] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Guatambú] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Grevillea] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Kiri] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br /><br />                  </font><font color="#0000aa">set</font><font color="#000000"> weight soil-mult </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"><br />                  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />                ][<br />                  </font><font color="#5a5a5a">; Combined effect</font><font color="#000000"><br />                  </font><font color="#0000aa">let</font><font color="#000000"> dist1-weight </font><font color="#963700">1.0</font><font color="#000000"><br />                  </font><font color="#0000aa">let</font><font color="#000000"> shade-effect (</font><font color="#660096">-</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000">)<br /><br />                  </font><font color="#0000aa">let</font><font color="#000000"> soil-mult </font><font color="#963700">0</font><font color="#000000"><br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Toona] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Lapacho] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Petiribí] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Anchico] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Araucaria] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Guatambú] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Grevillea] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Kiri] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br /><br />                  </font><font color="#0000aa">let</font><font color="#000000"> soil-effect soil-mult </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"><br /><br />                  </font><font color="#0000aa">set</font><font color="#000000"> weight dist1-weight </font><font color="#660096">+</font><font color="#000000"> shade-effect </font><font color="#660096">+</font><font color="#000000"> soil-effect<br /><br />                  </font><font color="#0000aa">ifelse</font><font color="#000000"> weight </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />                    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"> ]<br />                    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"> ]<br />                ]<br />              ]<br />            ]<br />          ]<br /><br />            </font><font color="#5a5a5a">; Set link thickness based on absolute weight</font><font color="#000000"><br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000"> weight<br />          ]<br />        ]<br />      ]<br /><br />      </font><font color="#5a5a5a">; NOW PROCESS SECOND NEIGHBORS</font><font color="#000000"><br />      </font><font color="#5a5a5a">; Find trees within second neighbor threshold but outside first neighbor threshold</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> second-neighbors sp </font><font color="#660096">with</font><font color="#000000"> [<br />        </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&gt;</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />        </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;</font><font color="#000000"> second-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />        </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">link-neighbor?</font><font color="#000000"> ilex-plant<br />       ]<br /><br />      </font><font color="#5a5a5a">; For each second neighbor, create a link</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> second-neighbors [<br />        </font><font color="#0000aa">let</font><font color="#000000"> this-tree </font><font color="#660096">self</font><font color="#000000">  </font><font color="#5a5a5a">; Store the tree agent for reference</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> draw-w-network? [<br />          </font><font color="#5a5a5a">; Create second-neighbor link</font><font color="#000000"><br />          </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> colour </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#5a5a5a">; Lighter shade of the species color for second neighbors</font><font color="#000000"><br />            </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type (</font><font color="#660096">word</font><font color="#000000"> selected-type </font><font color="#963700">&quot;-2&quot;</font><font color="#000000">) </font><font color="#5a5a5a">; Add &quot;-2&quot; to indicate second neighbor</font><font color="#000000"><br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000"><br /><br />            </font><font color="#0000aa">let</font><font color="#000000"> dist [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant] </font><font color="#660096">of</font><font color="#000000"> this-tree<br /><br />            </font><font color="#5a5a5a">; Calculate weight based on interaction type (for second neighbors)</font><font color="#000000"><br /><br />             </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;no-interaction&quot;</font><font color="#000000"> [<br />              </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">0</font><font color="#000000"><br />              </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />            ][<br /><br />            </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance&quot;</font><font color="#000000"> [<br />              </font><font color="#0000aa">set</font><font color="#000000"> weight </font><font color="#963700">0.5</font><font color="#000000"><br />              </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />            ][<br />              </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;shade&quot;</font><font color="#000000"> [<br />                </font><font color="#0000aa">set</font><font color="#000000"> weight (</font><font color="#660096">-</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">24</font><font color="#000000">)  </font><font color="#5a5a5a">; Reduced shade effect for second neighbors</font><font color="#000000"><br />                </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />              ][<br />                </font><font color="#0000aa">ifelse</font><font color="#000000"> selected-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;soil&quot;</font><font color="#000000"> [<br />                  </font><font color="#0000aa">let</font><font color="#000000"> soil-mult </font><font color="#963700">0</font><font color="#000000"><br /><br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Toona] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Lapacho] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Petiribí] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Anchico] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Araucaria] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Guatambú] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Grevillea] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Kiri] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br /><br />                  </font><font color="#0000aa">set</font><font color="#000000"> weight (soil-mult </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">  </font><font color="#5a5a5a">; Reduced effect (50%) for second neighbors</font><font color="#000000"><br />                  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"><br />                ][<br />                  </font><font color="#5a5a5a">; Combined effect for second neighbors</font><font color="#000000"><br />                  </font><font color="#0000aa">let</font><font color="#000000"> dist2-weight </font><font color="#963700">0.5</font><font color="#000000"><br />                  </font><font color="#0000aa">let</font><font color="#000000"> shade-effect (</font><font color="#660096">-</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">24</font><font color="#000000">) </font><font color="#5a5a5a">; Reduced shade effect</font><font color="#000000"><br /><br />                  </font><font color="#0000aa">let</font><font color="#000000"> soil-mult </font><font color="#963700">0</font><font color="#000000"><br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Toona] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Lapacho] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Petiribí] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Anchico] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Araucaria] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Guatambú] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Grevillea] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br />                  </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this-tree </font><font color="#660096">=</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Kiri] </font><font color="#660096">of</font><font color="#000000"> this-tree ]<br /><br />                  </font><font color="#0000aa">let</font><font color="#000000"> soil-effect (soil-mult </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">  </font><font color="#5a5a5a">; Reduced soil effect (50%) for second neighbors</font><font color="#000000"><br /><br />                  </font><font color="#0000aa">set</font><font color="#000000"> weight dist2-weight </font><font color="#660096">+</font><font color="#000000"> shade-effect </font><font color="#660096">+</font><font color="#000000"> soil-effect<br /><br />                  </font><font color="#0000aa">ifelse</font><font color="#000000"> weight </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />                    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"> ]<br />                    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"> ]<br />                ]<br />              ]<br />            ]<br />          ]<br /><br />            </font><font color="#5a5a5a">; Set link thickness based on absolute weight</font><font color="#000000"><br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000"> weight<br />          ]<br />        ]<br />      ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">; Report network creation results</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Created weighted network with interaction type: &quot;</font><font color="#000000"> interaction-type)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total links created: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;First-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Second-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Distance-1 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance-1&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Distance-2 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;distance-2&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Shade-1 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;shade-1&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Shade-2 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;shade-2&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil-1 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;soil-1&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil-2 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;soil-2&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Combined-1 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;combined-1&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Combined-2 links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [link-interaction-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;combined-2&quot;</font><font color="#000000">])<br /><br />  </font><font color="#5a5a5a">; Check a specific ilex plant</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Examining Ilex &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000">)<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  First neighbors: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [<br />      </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"><br />      [link-interaction-type] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> selected-type </font><font color="#963700">&quot;-1&quot;</font><font color="#000000">)<br />    ])<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Second neighbors: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [<br />      </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"><br />      [link-interaction-type] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> selected-type </font><font color="#963700">&quot;-2&quot;</font><font color="#000000">)<br />    ])<br />  ]<br /><br />  </font><font color="#5a5a5a">; Print final counts</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;======== FINAL LINK COUNTS ========&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Links with label '1st': &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Links with label '2nd': &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000">])<br /><br />  </font><font color="#5a5a5a">; Check for any unexpected interaction types</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> all-types </font><font color="#660096">remove-duplicates</font><font color="#000000"> [link-interaction-type] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;All interaction types present: &quot;</font><font color="#000000"> all-types)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; Create a multi-interaction network with all interaction types at once</font><font color="#000000"><br /></font><font color="#5a5a5a">; Extended to handle both first and second neighbors</font><font color="#000000"><br /></font><font color="#5a5a5a">; In your links-own declaration</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; Then in create-multi-interaction-network</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> create-multi-interaction-network<br />  </font><font color="#5a5a5a">; Clear any existing links before creating new ones</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> [ </font><font color="#0000aa">die</font><font color="#000000"> ]<br /><br />  </font><font color="#5a5a5a">; Define interaction types to calculate</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> interaction-type-list [</font><font color="#963700">&quot;distance&quot;</font><font color="#000000"> </font><font color="#963700">&quot;shade&quot;</font><font color="#000000"> </font><font color="#963700">&quot;soil&quot;</font><font color="#000000">]<br /><br />  </font><font color="#5a5a5a">; Define lists for species breeds and their corresponding link colors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br />  </font><font color="#0000aa">let</font><font color="#000000"> colors-list (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">53</font><font color="#000000"> </font><font color="#963700">55</font><font color="#000000"> </font><font color="#963700">57</font><font color="#000000"> </font><font color="#963700">63</font><font color="#000000"> </font><font color="#963700">67</font><font color="#000000"> </font><font color="#963700">43</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000"> </font><font color="#963700">77</font><font color="#000000"> </font><font color="#963700">74</font><font color="#000000">)<br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-colors (</font><font color="#660096">map</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> tree-list colors-list)<br /><br />  </font><font color="#5a5a5a">; Loop through each tree species</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> tree-colors [ pair -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> sp </font><font color="#660096">first</font><font color="#000000"> pair<br />    </font><font color="#0000aa">let</font><font color="#000000"> colour </font><font color="#660096">last</font><font color="#000000"> pair<br /><br />    </font><font color="#5a5a5a">; For each ilex plant</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />      </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br /><br />      </font><font color="#5a5a5a">; Process first neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> first-neighbors sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;=</font><font color="#000000"> nearest-neighbor-threshold]<br />      </font><font color="#0000aa">ask</font><font color="#000000"> first-neighbors [<br />        </font><font color="#0000aa">let</font><font color="#000000"> tree-agent </font><font color="#660096">self</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; Calculate distance weight</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> dist1-weight </font><font color="#963700">1.0</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; Calculate shade weight</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> shade-weight (</font><font color="#660096">-</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000">)<br /><br />        </font><font color="#5a5a5a">; Calculate soil effect</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> soil-mult </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Toona] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Lapacho] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Petiribí] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Anchico] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Araucaria] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Guatambú] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Grevillea] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Kiri] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br /><br />        </font><font color="#0000aa">let</font><font color="#000000"> soil-weight soil-mult </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; Calculate combined weight - now sum of all three interaction types</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> combined-weight dist1-weight </font><font color="#660096">+</font><font color="#000000"> shade-weight </font><font color="#660096">+</font><font color="#000000"> soil-weight<br /><br />        </font><font color="#5a5a5a">; Create a single link with all interaction types</font><font color="#000000"><br />        </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />          </font><font color="#5a5a5a">; Store the interaction type based on the global variable</font><font color="#000000"><br />          </font><font color="#5a5a5a">; but we're calculating all types regardless</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;combined&quot;</font><font color="#000000"> </font><font color="#963700">&quot;-1&quot;</font><font color="#000000">)<br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> neighbor-order </font><font color="#963700">1</font><font color="#000000"><br /><br />          </font><font color="#5a5a5a">; Store all individual weights</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-distance dist1-weight<br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-shade shade-weight<br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-soil soil-weight<br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-combined combined-weight<br /><br />          </font><font color="#5a5a5a">; Set the primary weight to be the combined weight</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight combined-weight<br /><br />          </font><font color="#5a5a5a">; Set color based on combined weight</font><font color="#000000"><br />          </font><font color="#0000aa">ifelse</font><font color="#000000"> weight </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">violet</font><font color="#000000"> ]<br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000"> ]<br /><br />          </font><font color="#5a5a5a">; Set thickness based on absolute weight</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000"> weight<br />        ]<br />      ]<br /><br />      </font><font color="#5a5a5a">; Process second neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> second-neighbors sp </font><font color="#660096">with</font><font color="#000000"> [<br />        </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&gt;</font><font color="#000000"> nearest-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />        </font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">&lt;</font><font color="#000000"> second-neighbor-threshold </font><font color="#660096">and</font><font color="#000000"><br />        </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">link-neighbor?</font><font color="#000000"> ilex-plant<br />      ]<br /><br />      </font><font color="#0000aa">ask</font><font color="#000000"> second-neighbors [<br />        </font><font color="#0000aa">let</font><font color="#000000"> tree-agent </font><font color="#660096">self</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; Calculate distance weight</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> dist2-weight </font><font color="#963700">0.5</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; Calculate shade weight</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> shade-weight (</font><font color="#660096">-</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">24</font><font color="#000000">)<br /><br />        </font><font color="#5a5a5a">; Calculate soil effect</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> soil-mult </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Toona] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Lapacho] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Petiribí] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Anchico] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Araucaria] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Guatambú] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Grevillea] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> tree-agent </font><font color="#660096">=</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-mult [soil-multiplier-Kiri] </font><font color="#660096">of</font><font color="#000000"> tree-agent ]<br /><br />        </font><font color="#0000aa">let</font><font color="#000000"> soil-weight (soil-mult </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; Calculate combined weight - now sum of all three interaction types</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> combined-weight dist2-weight </font><font color="#660096">+</font><font color="#000000"> shade-weight </font><font color="#660096">+</font><font color="#000000"> soil-weight<br /><br />        </font><font color="#5a5a5a">; Create a single link with all interaction types</font><font color="#000000"><br />        </font><font color="#0000aa">create-link-with</font><font color="#000000"> ilex-plant [<br />          </font><font color="#5a5a5a">; Store the interaction type based on the global variable</font><font color="#000000"><br />          </font><font color="#5a5a5a">; but we're calculating all types regardless</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> link-interaction-type (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;combined&quot;</font><font color="#000000"> </font><font color="#963700">&quot;-2&quot;</font><font color="#000000">)<br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> neighbor-order </font><font color="#963700">2</font><font color="#000000"><br /><br />          </font><font color="#5a5a5a">; Store all individual weights</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-distance dist2-weight<br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-shade shade-weight<br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-soil soil-weight<br />          </font><font color="#0000aa">set</font><font color="#000000"> weight-combined combined-weight<br /><br />          </font><font color="#5a5a5a">; Set the primary weight to be the combined weight</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> weight combined-weight<br /><br />          </font><font color="#5a5a5a">; Set color based on combined weight</font><font color="#000000"><br />          </font><font color="#0000aa">ifelse</font><font color="#000000"> weight </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">violet</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> ]<br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> ]<br /><br />          </font><font color="#5a5a5a">; Set thickness based on absolute weight</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000"> weight<br />        ]<br />      ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">; Report network creation results</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Created multi-interaction network with all interaction types stored in links&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total links created: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;First-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Second-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">])<br /><br />  </font><font color="#5a5a5a">; Report counts for all weights</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Weight summary:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Distance-1 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-distance </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Distance-2 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-distance </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Shade-1 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-shade </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Shade-2 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-shade </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Soil-1 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-soil </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Soil-2 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-soil </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Combined-1 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-combined </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Combined-2 weight links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [neighbor-order </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> weight-combined </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">])<br /><br />  </font><font color="#5a5a5a">; Check a specific ilex plant</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Examining Ilex &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000">)<br />    </font><font color="#0000aa">let</font><font color="#000000"> n1 </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"> [neighbor-order] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]<br />    </font><font color="#0000aa">let</font><font color="#000000"> n2 </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species0 </font><font color="#660096">and</font><font color="#000000"> [neighbor-order] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">]<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  First neighbors: &quot;</font><font color="#000000"> n1)<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;  Second neighbors: &quot;</font><font color="#000000"> n2)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; New procedure to export weighted adjacency matrix</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> export-weighted-matrix-with-time<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> num-turtles </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> weighted-matrix </font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#963700">0</font><font color="#000000">]]<br />  </font><font color="#0000aa">let</font><font color="#000000"> turtle-list </font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Fill the matrix with link weights</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ source -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> source-index </font><font color="#660096">position</font><font color="#000000"> source turtle-list<br />    </font><font color="#0000aa">ask</font><font color="#000000"> source [<br />      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> [<br />        </font><font color="#0000aa">let</font><font color="#000000"> target </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">end1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> source) [</font><font color="#660096">end2</font><font color="#000000">] [</font><font color="#660096">end1</font><font color="#000000">]<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-index </font><font color="#660096">position</font><font color="#000000"> target turtle-list<br />        </font><font color="#0000aa">set</font><font color="#000000"> weighted-matrix </font><font color="#660096">replace-item</font><font color="#000000"> source-index weighted-matrix (</font><font color="#660096">replace-item</font><font color="#000000"> target-index (</font><font color="#660096">item</font><font color="#000000"> source-index weighted-matrix) weight)<br />        </font><font color="#0000aa">set</font><font color="#000000"> weighted-matrix </font><font color="#660096">replace-item</font><font color="#000000"> target-index weighted-matrix (</font><font color="#660096">replace-item</font><font color="#000000"> source-index (</font><font color="#660096">item</font><font color="#000000"> target-index weighted-matrix) weight)<br /><br />      ]<br />    ]<br />  ]<br />  </font><font color="#5a5a5a">; Export to file</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;weighted_matrix_&quot;</font><font color="#000000"> interaction-type </font><font color="#963700">&quot;_tick_&quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> filename<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;source,target,weight,type,link-interaction-type&quot;</font><font color="#000000"><br />  </font><font color="#5a5a5a">; Write matrix in edge list format (more useful for network analysis)</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ source -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ target -&gt;<br />      </font><font color="#0000aa">let</font><font color="#000000"> w </font><font color="#660096">item</font><font color="#000000"> j </font><font color="#660096">item</font><font color="#000000"> i weighted-matrix<br />      </font><font color="#0000aa">if</font><font color="#000000"> w </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />        </font><font color="#0000aa">let</font><font color="#000000"> source-id [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> source<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-id [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target<br />        </font><font color="#0000aa">let</font><font color="#000000"> source-type [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> source<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-type [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target<br /><br />        </font><font color="#5a5a5a">; Find the actual link to get interaction type</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> int-type </font><font color="#963700">&quot;unknown&quot;</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> source [<br />          </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [<br />            (</font><font color="#660096">end1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> source </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">end2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> target) </font><font color="#660096">or</font><font color="#000000"><br />            (</font><font color="#660096">end1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> target </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">end2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> source)<br />          ] [<br />            </font><font color="#0000aa">set</font><font color="#000000"> int-type link-interaction-type<br />          ]<br />        ]<br /><br />        </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> source-id </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> target-id </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> w </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> source-type </font><font color="#963700">&quot;-&quot;</font><font color="#000000"> target-type </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> int-type)<br />      ]<br />      </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br />  </font><font color="#5a5a5a">; Print debugging information</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Matrix exported to &quot;</font><font color="#000000"> filename)<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total links in network: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;First-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000">])<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Second-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000">])<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Links written to file: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;File format: source,target,weight,type,link-interaction-type&quot;</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> export-weighted-matrix-with-coordinates<br />  </font><font color="#0000aa">let</font><font color="#000000"> num-turtles </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> weighted-matrix </font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#963700">0</font><font color="#000000">]]<br />  </font><font color="#0000aa">let</font><font color="#000000"> turtle-list </font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Fill the matrix with link weights</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ source -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> source-index </font><font color="#660096">position</font><font color="#000000"> source turtle-list<br />    </font><font color="#0000aa">ask</font><font color="#000000"> source [<br />      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> [<br />        </font><font color="#0000aa">let</font><font color="#000000"> target </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">end1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> source) [</font><font color="#660096">end2</font><font color="#000000">] [</font><font color="#660096">end1</font><font color="#000000">]<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-index </font><font color="#660096">position</font><font color="#000000"> target turtle-list<br />        </font><font color="#0000aa">set</font><font color="#000000"> weighted-matrix </font><font color="#660096">replace-item</font><font color="#000000"> source-index weighted-matrix (</font><font color="#660096">replace-item</font><font color="#000000"> target-index (</font><font color="#660096">item</font><font color="#000000"> source-index weighted-matrix) weight)<br />        </font><font color="#0000aa">set</font><font color="#000000"> weighted-matrix </font><font color="#660096">replace-item</font><font color="#000000"> target-index weighted-matrix (</font><font color="#660096">replace-item</font><font color="#000000"> source-index (</font><font color="#660096">item</font><font color="#000000"> target-index weighted-matrix) weight)<br />      ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">; Export edge list with coordinates to file</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;weighted_matrix_with_coords_&quot;</font><font color="#000000"> interaction-type </font><font color="#963700">&quot;_tick_&quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> filename<br /><br />  </font><font color="#5a5a5a">; Modified header to include coordinates</font><font color="#000000"><br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;source,target,weight,type,link-interaction-type,source_x,source_y,target_x,target_y&quot;</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Write matrix in edge list format with coordinates</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ source -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [ target -&gt;<br />      </font><font color="#0000aa">let</font><font color="#000000"> w </font><font color="#660096">item</font><font color="#000000"> j </font><font color="#660096">item</font><font color="#000000"> i weighted-matrix<br />      </font><font color="#0000aa">if</font><font color="#000000"> w </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />        </font><font color="#0000aa">let</font><font color="#000000"> source-id [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> source<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-id [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target<br />        </font><font color="#0000aa">let</font><font color="#000000"> source-type [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> source<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-type [</font><font color="#660096">breed</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target<br /><br />        </font><font color="#5a5a5a">; Get coordinates for source and target</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> source-x [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> source<br />        </font><font color="#0000aa">let</font><font color="#000000"> source-y [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> source<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-x [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target<br />        </font><font color="#0000aa">let</font><font color="#000000"> target-y [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target<br /><br />        </font><font color="#5a5a5a">; Find the actual link to get interaction type</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> int-type </font><font color="#963700">&quot;unknown&quot;</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> source [<br />          </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [<br />            (</font><font color="#660096">end1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> source </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">end2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> target) </font><font color="#660096">or</font><font color="#000000"><br />            (</font><font color="#660096">end1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> target </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">end2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> source)<br />          ] [<br />            </font><font color="#0000aa">set</font><font color="#000000"> int-type link-interaction-type<br />          ]<br />        ]<br /><br />        </font><font color="#5a5a5a">; Write line with coordinates</font><font color="#000000"><br />        </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> source-id </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> target-id </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> w </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> source-type </font><font color="#963700">&quot;-&quot;</font><font color="#000000"> target-type </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> int-type </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                   source-x </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> source-y </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> target-x </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> target-y)<br />      ]<br />      </font><font color="#0000aa">set</font><font color="#000000"> j j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Print debugging information</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Matrix with coordinates exported to &quot;</font><font color="#000000"> filename)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total links in network: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;First-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;1st&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Second-neighbor links: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;2nd&quot;</font><font color="#000000">])<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Links written to file: &quot;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">)<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;File format: source,target,weight,type,link-interaction-type,source_x,source_y,target_x,target_y&quot;</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">; Additionally, we can create a procedure to export only node coordinates</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> export-node-coordinates<br />  </font><font color="#0000aa">let</font><font color="#000000"> filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;node_coordinates_tick_&quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> filename<br /><br />  </font><font color="#5a5a5a">; Header for node coordinates file</font><font color="#000000"><br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;node_id,breed,xcor,ycor&quot;</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">; Write coordinates for all turtles</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000">)<br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Node coordinates exported to &quot;</font><font color="#000000"> filename)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> set-soil-factor<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">      [<br />      </font><font color="#0000aa">ifelse</font><font color="#000000">  soil </font><font color="#660096">=</font><font color="#000000"> soil1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor  </font><font color="#963700">1.12</font><font color="#000000">   ]<br />      [</font><font color="#0000aa">ifelse</font><font color="#000000"> soil </font><font color="#660096">=</font><font color="#000000"> soil2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">1.0</font><font color="#000000"> ]<br />      [</font><font color="#0000aa">ifelse</font><font color="#000000"> soil </font><font color="#660096">=</font><font color="#000000"> soil3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">0.95</font><font color="#000000"> ]<br />      [</font><font color="#0000aa">ifelse</font><font color="#000000"> soil </font><font color="#660096">=</font><font color="#000000"> soil4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">0.85</font><font color="#000000"> ]<br />                           [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">0.80</font><font color="#000000"> ]<br />          ]<br />        ]<br />      ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> energy-account<br />  </font><font color="#0000aa">set</font><font color="#000000"> N  </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">                                   </font><font color="#5a5a5a">;; the number of patches will be used to obtain averages</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> start? [<br />        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">  [ </font><font color="#0000aa">set</font><font color="#000000"> soil-energy soil  ]           </font><font color="#5a5a5a">;; It is a duplicate that facilitates operations: growth, crop, trimming, fertilization which are operationalized for each soil type</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> start? </font><font color="#963700">false</font><font color="#000000">                                 </font><font color="#5a5a5a">;; scaling soil type to growth energy; more fertility more energy given to plants in energy-trees</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />      [ </font><font color="#0000aa">set</font><font color="#000000"> et </font><font color="#963700">2.5</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> soil-factor<br />  ]<br />    </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> species-name (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> i)<br />    </font><font color="#0000aa">let</font><font color="#000000"> energy-var (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;energy-&quot;</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> i [</font><font color="#963700">&quot;ilex&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Cañafístola&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Lapacho&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Petiribí&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Anchico&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Araucaria&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Guatambú&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Grevillea&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Kiri&quot;</font><font color="#000000">]))<br />    </font><font color="#0000aa">ask</font><font color="#000000"> (</font><font color="#660096">turtle-set</font><font color="#000000"> </font><font color="#660096">runresult</font><font color="#000000"> species-name) [<br />      </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set &quot;</font><font color="#000000"> energy-var </font><font color="#963700">&quot; 1 * et&quot;</font><font color="#000000">)             </font><font color="#5a5a5a">;; each species will obtain a species-specific amount of energy; here the scaling is 1</font><font color="#000000"><br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> grow<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [ recalibrate-ilex-growth  growth-rate-ilex]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species1 [ grow-at-rate growth-rate-toona ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species2 [ grow-at-rate growth-rate-cana ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species3 [ grow-at-rate growth-rate-la ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species4 [ grow-at-rate growth-rate-pet ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species5 [ grow-at-rate growth-rate-an ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species6 [ grow-at-rate growth-rate-ar ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species7 [ grow-at-rate growth-rate-gu ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species8 [ grow-at-rate growth-rate-gr ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species9 [ grow-at-rate growth-rate-ki ]<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">156</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> growth-energy-uptake (et </font><font color="#660096">*</font><font color="#000000"> Ni </font><font color="#660096">+</font><font color="#000000"> et </font><font color="#660096">*</font><font color="#000000"> Nt) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> ]<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> growth-energy-uptake (et </font><font color="#660096">*</font><font color="#000000"> Ni </font><font color="#660096">+</font><font color="#000000"> et </font><font color="#660096">*</font><font color="#000000"> Nt) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> ]<br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> soil-energy   soil-energy </font><font color="#660096">-</font><font color="#000000"> growth-energy-uptake]<br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species0 turtles Growing :&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br />   </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species1 turtles Growing:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species1 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> recalibrate-ilex-growth [rate]<br />  </font><font color="#0000aa">let</font><font color="#000000"> combined-soil-factor soil-factor </font><font color="#660096">*</font><font color="#000000"> [local-soil-factor] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-here</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (((</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> rate) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)) </font><font color="#660096">*</font><font color="#000000"> combined-soil-factor)<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> grow-at-rate [rate]<br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (((</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> rate ) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">) ) </font><font color="#660096">*</font><font color="#000000"> soil-factor)<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> system-growth-energy-uptake<br /></font><font color="#0000aa">report</font><font color="#000000"> growth-energy-uptake<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> compete-shade<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [                                                               </font><font color="#5a5a5a">;; Create an agentset of all other species</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> tree-agentset (</font><font color="#660096">turtle-set</font><font color="#000000"> tree-set)                                    </font><font color="#5a5a5a">;; Find neighbors within a radius of 7.5, excluding self</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> nearby-neighbors tree-agentset </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">7.5</font><font color="#000000">                           </font><font color="#5a5a5a">;; Find up to 4 closest neighbors from those within radius 7.5</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> closest-neighbors </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> nearby-neighbors </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">)<br />      [ </font><font color="#660096">min-n-of</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> nearby-neighbors [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">] ]<br />      [ nearby-neighbors ]                                                     </font><font color="#5a5a5a">;; If fewer than 4 neighbors within radius 7.5, use all of them</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> closest-neighbors [                                                </font><font color="#5a5a5a">;; Only proceed if there are any close neighbors</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> avg-size </font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> closest-neighbors                              </font><font color="#5a5a5a">;; Calculate the average size of these closest neighbors</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> shade-factor </font><font color="#660096">max</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (avg-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">30</font><font color="#000000">) </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)  </font><font color="#963700">0.7</font><font color="#000000">)                 </font><font color="#5a5a5a">;; Ensure shade doesn't reduce growth by more than 70%</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> avg-size </font><font color="#660096">&gt;</font><font color="#000000"> tree-thin-size [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> shade-factor             </font><font color="#5a5a5a">;; Reduce size if average size is greater than 9, same size that triggers thinning</font><font color="#000000"><br />      ]<br />      [<br />        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">9</font><font color="#000000"> [ </font><font color="#0000aa">stop</font><font color="#000000">                                                     </font><font color="#5a5a5a">;; normal increase in size if less than 9</font><font color="#000000"><br />        ]<br />      ]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> harvest-ilex<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Harvest-ilex called&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species0 turtles before harvest:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;harvest_per_plant.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> filename<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;tick,who,harvested,total_neighbors,species1_neighbors,species2_neighbors,species3_neighbors,species4_neighbors,species5_neighbors,species6_neighbors,species7_neighbors,species8_neighbors,species9_neighbors&quot;</font><font color="#000000"><br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> individual-harvest </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size [<br />      </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />      ]<br /><br />      </font><font color="#0000aa">set</font><font color="#000000"> individual-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />      </font><font color="#0000aa">set</font><font color="#000000"> harvest-amount </font><font color="#660096">lput</font><font color="#000000"> individual-harvest harvest-amount<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> local-harvest-rate)<br />      </font><font color="#0000aa">set</font><font color="#000000"> energy-ilex (energy-ilex </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1.25</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate </font><font color="#660096">*</font><font color="#000000"> et)<br />      </font><font color="#0000aa">set</font><font color="#000000"> total-harvest (</font><font color="#660096">sum</font><font color="#000000"> harvest-amount)<br />      </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-mate ((</font><font color="#660096">sum</font><font color="#000000"> harvest-amount </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.75</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> convert-dry </font><font color="#660096">*</font><font color="#000000"> convert-SOM)<br /><br />      </font><font color="#5a5a5a">;; Count neighbors by species type</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> total-neighbors </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species1-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species1])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species2-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species2])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species3-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species3])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species4-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species4])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species5-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species5])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species6-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species6])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species7-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species7])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species8-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species8])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species9-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species9])<br /><br />      </font><font color="#5a5a5a">;; Export each turtle's record to CSV with neighbor breakdown</font><font color="#000000"><br />      </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> individual-harvest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      total-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species1-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species2-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species3-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species4-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species5-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species6-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species7-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species8-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species9-neighbors)<br />    ]<br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; Create analysis summary</font><font color="#000000"><br />  create-harvest-by-species-analysis<br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;tick &quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot; total harvest: &quot;</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> harvest-amount)<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species0 turtles after harvest:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;sum harvest-amount : &quot;</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> harvest-amount)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-mate-Increment: &quot;</font><font color="#000000"> soil-multiplier-mate)<br />  update-soil-multipliers-mate soil-multiplier-mate<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> create-harvest-by-species-analysis<br />  </font><font color="#0000aa">let</font><font color="#000000"> analysis-filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;harvest_analysis_by_species_&quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> analysis-filename<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;neighbor_species,total_harvest,avg_harvest_per_plant,num_plants,avg_neighbors_per_plant&quot;</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;; Analyze harvest for plants with each species neighbor type</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> species-breed </font><font color="#660096">runresult</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> i)<br />    </font><font color="#0000aa">let</font><font color="#000000"> ilex-with-this-neighbor species0 </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species-breed]]<br /><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> ilex-with-this-neighbor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#5a5a5a">;; Only include plants that were actually harvested in this tick (size &gt;= harvest-size)</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> harvested-ilex-with-this-neighbor ilex-with-this-neighbor </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size]<br /><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-with-this-neighbor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />        </font><font color="#5a5a5a">;; Calculate harvest for each plant in this group (same formula as in harvest-ilex)</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> total-harvest-this-species </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> harvest-count </font><font color="#963700">0</font><font color="#000000"><br /><br />        </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-with-this-neighbor [<br />          </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />          </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />            </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />          ]<br />          </font><font color="#0000aa">let</font><font color="#000000"> this-plant-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />          </font><font color="#0000aa">set</font><font color="#000000"> total-harvest-this-species total-harvest-this-species </font><font color="#660096">+</font><font color="#000000"> this-plant-harvest<br />          </font><font color="#0000aa">set</font><font color="#000000"> harvest-count harvest-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />        ]<br /><br />        </font><font color="#5a5a5a">;; Calculate statistics for this group</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> avg-harvest-this-species total-harvest-this-species </font><font color="#660096">/</font><font color="#000000"> harvest-count<br />        </font><font color="#0000aa">let</font><font color="#000000"> num-plants-this-species </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-with-this-neighbor<br /><br />        </font><font color="#5a5a5a">;; Calculate average neighbors of this species type</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> total-neighbors-count </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-with-this-neighbor [<br />          </font><font color="#0000aa">set</font><font color="#000000"> total-neighbors-count total-neighbors-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species-breed])<br />        ]<br />        </font><font color="#0000aa">let</font><font color="#000000"> avg-neighbors-this-species total-neighbors-count </font><font color="#660096">/</font><font color="#000000"> num-plants-this-species<br /><br />        </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> i </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> total-harvest-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                        avg-harvest-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> num-plants-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> avg-neighbors-this-species)<br />      ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">;; Also analyze ilex with no tree neighbors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> ilex-no-neighbors species0 </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">]<br />  </font><font color="#0000aa">let</font><font color="#000000"> harvested-ilex-no-neighbors ilex-no-neighbors </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-no-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#5a5a5a">;; Calculate harvest for no-neighbor plants</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> total-harvest-no-neighbors </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> harvest-count-no-neighbors </font><font color="#963700">0</font><font color="#000000"><br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-no-neighbors [<br />      </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />      ]<br />      </font><font color="#0000aa">let</font><font color="#000000"> this-plant-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />      </font><font color="#0000aa">set</font><font color="#000000"> total-harvest-no-neighbors total-harvest-no-neighbors </font><font color="#660096">+</font><font color="#000000"> this-plant-harvest<br />      </font><font color="#0000aa">set</font><font color="#000000"> harvest-count-no-neighbors harvest-count-no-neighbors </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    ]<br /><br />    </font><font color="#0000aa">let</font><font color="#000000"> avg-harvest-no-neighbors total-harvest-no-neighbors </font><font color="#660096">/</font><font color="#000000"> harvest-count-no-neighbors<br />    </font><font color="#0000aa">let</font><font color="#000000"> num-plants-no-neighbors </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-no-neighbors<br /><br />    </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;no_tree_neighbors,&quot;</font><font color="#000000"> total-harvest-no-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                    avg-harvest-no-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> num-plants-no-neighbors </font><font color="#963700">&quot;,0&quot;</font><font color="#000000">)<br />  ]<br /><br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-harvest-mate<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> total-harvest] </font><font color="#660096">of</font><font color="#000000"> species0<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> harvest-ilex-nearest-neighbors<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Harvest-ilex-nearest-neighbors called&quot;</font><font color="#000000"><br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;harvest_per_plant_nearest_neighbors.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> filename<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;tick,who,harvested,total_nearest_neighbors,species1_nearest,species2_nearest,species3_nearest,species4_nearest,species5_nearest,species6_nearest,species7_nearest,species8_nearest,species9_nearest&quot;</font><font color="#000000"><br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> individual-harvest </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size [<br />      </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />      ]<br /><br />      </font><font color="#0000aa">set</font><font color="#000000"> individual-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br /><br />      </font><font color="#5a5a5a">;; Count ONLY nearest neighbors (using same logic as create-network)</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br /><br />      </font><font color="#5a5a5a">;; Initialize nearest neighbor counts</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species1-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species2-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species3-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species4-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species5-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species6-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species7-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species8-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species9-nearest </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> total-nearest-neighbors </font><font color="#963700">0</font><font color="#000000"><br /><br />      </font><font color="#5a5a5a">;; For each species, find the nearest neighbors within threshold</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br /><br />      </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">9</font><font color="#000000">) [ i -&gt;<br />        </font><font color="#0000aa">let</font><font color="#000000"> sp </font><font color="#660096">item</font><font color="#000000"> i tree-list<br />        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> sp </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />          </font><font color="#5a5a5a">;; Find minimum distance to any turtle of this species</font><font color="#000000"><br />          </font><font color="#0000aa">let</font><font color="#000000"> min-dist </font><font color="#660096">min</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant] </font><font color="#660096">of</font><font color="#000000"> sp<br />          </font><font color="#5a5a5a">;; Find all trees of this species at minimum distance</font><font color="#000000"><br />          </font><font color="#0000aa">let</font><font color="#000000"> closest-trees sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant </font><font color="#660096">=</font><font color="#000000"> min-dist]<br />          </font><font color="#5a5a5a">;; Only count if within nearest neighbor threshold (7.1)</font><font color="#000000"><br />          </font><font color="#0000aa">if</font><font color="#000000"> min-dist </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">7.1</font><font color="#000000"> [<br />            </font><font color="#0000aa">let</font><font color="#000000"> nearest-count </font><font color="#660096">count</font><font color="#000000"> closest-trees<br />            </font><font color="#5a5a5a">;; Assign to appropriate species counter</font><font color="#000000"><br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species1-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species2-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species3-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species4-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species5-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species6-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">6</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species7-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">7</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species8-nearest nearest-count ]<br />            </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">8</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species9-nearest nearest-count ]<br />            </font><font color="#0000aa">set</font><font color="#000000"> total-nearest-neighbors total-nearest-neighbors </font><font color="#660096">+</font><font color="#000000"> nearest-count<br />          ]<br />        ]<br />      ]<br /><br />      </font><font color="#5a5a5a">;; Export each turtle's record to CSV with nearest neighbor breakdown</font><font color="#000000"><br />      </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> individual-harvest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      total-nearest-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species1-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species2-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species3-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species4-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species5-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species6-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species7-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species8-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species9-nearest)<br />    ]<br />  ]<br /><br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;; Create nearest neighbors analysis summary</font><font color="#000000"><br />  create-harvest-by-nearest-neighbors-analysis<br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Nearest neighbors harvest analysis completed&quot;</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Analysis procedure for nearest neighbors only</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> create-harvest-by-nearest-neighbors-analysis<br />  </font><font color="#0000aa">let</font><font color="#000000"> analysis-filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;harvest_analysis_nearest_neighbors_&quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> analysis-filename<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;neighbor_species,total_harvest,avg_harvest_per_plant,num_plants,avg_nearest_neighbors_per_plant&quot;</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;; Define tree species list</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br /><br />  </font><font color="#5a5a5a">;; Analyze harvest for plants with each species as nearest neighbor</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">9</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> sp </font><font color="#660096">item</font><font color="#000000"> i tree-list<br />    </font><font color="#0000aa">let</font><font color="#000000"> species-num i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br /><br />    </font><font color="#5a5a5a">;; Find ilex plants that have this species as nearest neighbor</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> ilex-with-nearest-neighbor species0 </font><font color="#660096">with</font><font color="#000000"> [<br />      </font><font color="#660096">count</font><font color="#000000"> sp </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">min</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> sp </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">7.1</font><font color="#000000"><br />    ]<br /><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> ilex-with-nearest-neighbor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#5a5a5a">;; Only include plants that were actually harvested</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> harvested-ilex-with-nearest ilex-with-nearest-neighbor </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size]<br /><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-with-nearest </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />        </font><font color="#5a5a5a">;; Calculate harvest for each plant in this group</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> total-harvest-this-species </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> harvest-count </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> total-nearest-count </font><font color="#963700">0</font><font color="#000000"><br /><br />        </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-with-nearest [<br />          </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />          </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />            </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />          ]<br />          </font><font color="#0000aa">let</font><font color="#000000"> this-plant-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />          </font><font color="#0000aa">set</font><font color="#000000"> total-harvest-this-species total-harvest-this-species </font><font color="#660096">+</font><font color="#000000"> this-plant-harvest<br />          </font><font color="#0000aa">set</font><font color="#000000"> harvest-count harvest-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br /><br />          </font><font color="#5a5a5a">;; Count nearest neighbors of this species for this plant</font><font color="#000000"><br />          </font><font color="#0000aa">let</font><font color="#000000"> min-dist </font><font color="#660096">min</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> sp<br />          </font><font color="#0000aa">let</font><font color="#000000"> nearest-of-this-species </font><font color="#660096">count</font><font color="#000000"> (sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> min-dist </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">7.1</font><font color="#000000">])<br />          </font><font color="#0000aa">set</font><font color="#000000"> total-nearest-count total-nearest-count </font><font color="#660096">+</font><font color="#000000"> nearest-of-this-species<br />        ]<br /><br />        </font><font color="#5a5a5a">;; Calculate statistics for this group</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> avg-harvest-this-species total-harvest-this-species </font><font color="#660096">/</font><font color="#000000"> harvest-count<br />        </font><font color="#0000aa">let</font><font color="#000000"> num-plants-this-species </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-with-nearest<br />        </font><font color="#0000aa">let</font><font color="#000000"> avg-nearest-this-species total-nearest-count </font><font color="#660096">/</font><font color="#000000"> num-plants-this-species<br /><br />        </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> species-num </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> total-harvest-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                        avg-harvest-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> num-plants-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> avg-nearest-this-species)<br />      ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">;; Also analyze ilex with no nearest neighbors (control group)</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> ilex-no-nearest-neighbors species0<br /><br />  </font><font color="#5a5a5a">;; Filter out plants that have ANY species as nearest neighbor</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> ilex-no-nearest-neighbors [<br />    </font><font color="#0000aa">let</font><font color="#000000"> has-nearest-neighbor </font><font color="#963700">false</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> ilex-plant </font><font color="#660096">self</font><font color="#000000"><br />    </font><font color="#0000aa">foreach</font><font color="#000000"> tree-list [ sp -&gt;<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> sp </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />        </font><font color="#0000aa">let</font><font color="#000000"> min-dist </font><font color="#660096">min</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> ilex-plant] </font><font color="#660096">of</font><font color="#000000"> sp<br />        </font><font color="#0000aa">if</font><font color="#000000"> min-dist </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">7.1</font><font color="#000000"> [<br />          </font><font color="#0000aa">set</font><font color="#000000"> has-nearest-neighbor </font><font color="#963700">true</font><font color="#000000"><br />        ]<br />      ]<br />    ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> has-nearest-neighbor [<br />      </font><font color="#0000aa">set</font><font color="#000000"> ilex-no-nearest-neighbors ilex-no-nearest-neighbors </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">self</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> ilex-plant]<br />    ]<br />  ]<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> harvested-ilex-no-nearest ilex-no-nearest-neighbors </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-no-nearest </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#5a5a5a">;; Calculate harvest for control group</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> total-harvest-no-nearest </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> harvest-count-no-nearest </font><font color="#963700">0</font><font color="#000000"><br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-no-nearest [<br />      </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />      ]<br />      </font><font color="#0000aa">let</font><font color="#000000"> this-plant-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />      </font><font color="#0000aa">set</font><font color="#000000"> total-harvest-no-nearest total-harvest-no-nearest </font><font color="#660096">+</font><font color="#000000"> this-plant-harvest<br />      </font><font color="#0000aa">set</font><font color="#000000"> harvest-count-no-nearest harvest-count-no-nearest </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    ]<br /><br />    </font><font color="#0000aa">let</font><font color="#000000"> avg-harvest-no-nearest total-harvest-no-nearest </font><font color="#660096">/</font><font color="#000000"> harvest-count-no-nearest<br />    </font><font color="#0000aa">let</font><font color="#000000"> num-plants-no-nearest </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-no-nearest<br /><br />    </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;no_nearest_neighbors,&quot;</font><font color="#000000"> total-harvest-no-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                    avg-harvest-no-nearest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> num-plants-no-nearest </font><font color="#963700">&quot;,0&quot;</font><font color="#000000">)<br />  ]<br /><br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> trim-trees<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species1 turtles before trim:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species1 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-harvest </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> species-multipliers table:make                                             </font><font color="#5a5a5a">;; Use a table to track multipliers per species</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> trim-factors [</font><font color="#963700">0.61</font><font color="#000000">  </font><font color="#963700">0.75</font><font color="#000000">  </font><font color="#963700">0.67</font><font color="#000000">  </font><font color="#963700">0.69</font><font color="#000000">  </font><font color="#963700">0.76</font><font color="#000000">  </font><font color="#963700">0.8</font><font color="#000000">  </font><font color="#963700">0.64</font><font color="#000000">  </font><font color="#963700">0.74</font><font color="#000000">  </font><font color="#963700">0.65</font><font color="#000000">]         </font><font color="#5a5a5a">;; The product of these factors with growth rates equals 1.</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species-names [</font><font color="#963700">&quot;Toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Cañafístola&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Lapacho&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Petiribí&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Anchico&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Araucaria&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Guatambú&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Grevillea&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Kiri&quot;</font><font color="#000000">]<br /><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> breed-name (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> (i))<br />    </font><font color="#0000aa">let</font><font color="#000000"> species-name </font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) species-names<br />    </font><font color="#0000aa">let</font><font color="#000000"> trim-factor </font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) trim-factors<br />    </font><font color="#0000aa">let</font><font color="#000000"> multipliers-species-contribution </font><font color="#963700">0</font><font color="#000000"><br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> (</font><font color="#660096">turtle-set</font><font color="#000000"> </font><font color="#660096">runresult</font><font color="#000000"> breed-name) [<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> tree-trim-size [<br />        </font><font color="#0000aa">set</font><font color="#000000"> tree-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> trim-factor)<br />        </font><font color="#0000aa">set</font><font color="#000000"> harvest-trees (tree-harvest)<br />        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> trim-factor<br />        </font><font color="#0000aa">let</font><font color="#000000"> current-energy </font><font color="#660096">runresult</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;energy-&quot;</font><font color="#000000"> species-name)<br />        </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set energy-&quot;</font><font color="#000000"> species-name </font><font color="#963700">&quot; &quot;</font><font color="#000000"> (current-energy </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">0.3</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> et))<br /><br />        </font><font color="#5a5a5a">; Calculate this tree's contribution</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> tree-soil-contribution harvest-trees </font><font color="#660096">*</font><font color="#000000"> (convert-dry </font><font color="#660096">*</font><font color="#000000"> convert-SOM)<br /><br />        </font><font color="#5a5a5a">; Add to the species total</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> multipliers-species-contribution multipliers-species-contribution </font><font color="#660096">+</font><font color="#000000"> tree-soil-contribution<br /><br />        </font><font color="#5a5a5a">; IMPORTANT NEW CODE: Assign soil multiplier value to this specific tree</font><font color="#000000"><br />        </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set soil-multiplier-&quot;</font><font color="#000000"> species-name </font><font color="#963700">&quot; &quot;</font><font color="#000000"> tree-soil-contribution)<br />      ]<br />    ]<br />    table:put species-multipliers species-name multipliers-species-contribution<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Table species-multipliers: &quot;</font><font color="#000000"> species-multipliers)<br />  </font><font color="#0000aa">let</font><font color="#000000"> total-increment-multipliers </font><font color="#660096">sum</font><font color="#000000"> table:values species-multipliers<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total-increment-multipliers sum: &quot;</font><font color="#000000"> total-increment-multipliers)<br />  update-soil-multipliers-trimm total-increment-multipliers<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> fertilize<br />  </font><font color="#0000aa">let</font><font color="#000000"> fertilizers-solubility  soil-multiplier </font><font color="#660096">*</font><font color="#000000"> buffer-factor<br />  </font><font color="#0000aa">set</font><font color="#000000">  fertilizer-amount  ( reposition </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> ) </font><font color="#660096">*</font><font color="#000000"> growth-energy-uptake </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">        </font><font color="#5a5a5a">;; percentage of tree consumption that is externally supplied</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-gain fertilizer-amount </font><font color="#660096">*</font><font color="#000000"> ( </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> fertilizers-solubility)            </font><font color="#5a5a5a">;; the external imput is leveraged by the multipliers</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> soil-energy  ( soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain ) ]                   </font><font color="#5a5a5a">;; soil-energy is incrased by the gain from the direct</font><font color="#000000"><br />  print-harvest-fertilizer-stats                                                 </font><font color="#5a5a5a">;; energy multipliers contribution, the external imput, and the multipliers on the external imput</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> print-harvest-fertilizer-stats<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> total-harvest </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">let</font><font color="#000000"> ratio ( fertilizer-amount </font><font color="#660096">/</font><font color="#000000"> total-harvest )<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;fertilizer-harvest-ratio: &quot;</font><font color="#000000"> ratio )<br />  ]<br />    [ </font><font color="#0000aa">let</font><font color="#000000"> ratio </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;fertilizer-harvest-ratio: &quot;</font><font color="#000000"> ratio )<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total harvest: &quot;</font><font color="#000000"> total-harvest )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Growth Energy Uptake: &quot;</font><font color="#000000"> growth-energy-uptake )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-for-fertilizer-amount: &quot;</font><font color="#000000"> soil-multiplier )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-energy: &quot;</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Fertilizer amount: &quot;</font><font color="#000000"> fertilizer-amount )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Fertilizer-Harvest Ratio: &quot;</font><font color="#000000"> fertilizer-harvest-ratio)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> perform-thinning [ycor-list]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> tree-thin-size </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> ycor-list [<br />      thin-tree<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> decay-local-soil-factor<br />  </font><font color="#0000aa">let</font><font color="#000000"> decay-rate </font><font color="#963700">0.0268</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> time-rebalance ( </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> last-rebalance ) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> last-rebalance  </font><font color="#660096">ticks</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> previous-soil-energy </font><font color="#660096">mean</font><font color="#000000"> [soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor local-soil-factor </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)      </font><font color="#5a5a5a">;; Adjust this value as needed</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor </font><font color="#963700">1</font><font color="#000000">]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> rebalance-soil<br />  </font><font color="#0000aa">let</font><font color="#000000"> decay-rate </font><font color="#963700">0.0268</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> time-rebalance ( </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> last-rebalance ) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">write</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;time-rebalance:&quot;</font><font color="#000000"> time-rebalance)<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> current </font><font color="#660096">mean</font><font color="#000000"> [soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> previous-soil-energy </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [  </font><font color="#0000aa">set</font><font color="#000000"> soil-energy-improvement (current </font><font color="#660096">/</font><font color="#000000"> previous-soil-energy) ]<br />  [   ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> minreposition? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">True</font><font color="#000000"> [<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> soil-energy-improvement </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1.44</font><font color="#000000"> [                                                    </font><font color="#5a5a5a">;; If improvement is greater than 20%</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> reposition </font><font color="#660096">max</font><font color="#000000"> ( </font><font color="#660096">list</font><font color="#000000"> (reposition </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.6</font><font color="#000000"> ) </font><font color="#963700">10</font><font color="#000000"> )                                     </font><font color="#5a5a5a">;; Reduce by 20% but not below 10%</font><font color="#000000"><br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil improvement: &quot;</font><font color="#000000"> </font><font color="#660096">precision</font><font color="#000000"> ((soil-energy-improvement </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">) </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Reducing reposition to: &quot;</font><font color="#000000"> reposition </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br />  ]<br />     [</font><font color="#0000aa">if</font><font color="#000000"> soil-energy-improvement </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [                                                       </font><font color="#5a5a5a">;; If improvement is greater than 25%</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> reposition  </font><font color="#660096">min</font><font color="#000000"> ( </font><font color="#660096">list</font><font color="#000000"> (reposition </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.20</font><font color="#000000"> ) </font><font color="#963700">200</font><font color="#000000">  )] ]                              </font><font color="#5a5a5a">;;</font><font color="#000000"><br /><br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil improvement: &quot;</font><font color="#000000"> </font><font color="#660096">precision</font><font color="#000000"> ((soil-energy-improvement </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">) </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Reducing reposition to: &quot;</font><font color="#000000"> reposition </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier soil-multiplier </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-mate soil-multiplier-mate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees soil-multiplier-trees </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)<br /><br />  </font><font color="#0000aa">set</font><font color="#000000"> last-rebalance  </font><font color="#660096">ticks</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor local-soil-factor </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate  </font><font color="#660096">*</font><font color="#000000"> time-rebalance)     </font><font color="#5a5a5a">;; Adjust this value as needed</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor </font><font color="#963700">1</font><font color="#000000">]<br />    ]<br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> soil current-soil-energy ]                                           </font><font color="#5a5a5a">;; the soil type changes and the colors change to map this continuously</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  [ </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil<br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">49</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil1 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil </font><font color="#660096">and</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">39</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil2 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil </font><font color="#660096">and</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">29</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil3 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil </font><font color="#660096">and</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">19</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil4 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000"><br />   [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">  </font><font color="#963700">139</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil5 soil ]<br />  ]<br /> </font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; IMPROVED: Clean logging with separate columns for event types and values</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Modified header to include separate increment value column</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> initialize-soil-monitoring<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-csv-header-written? </font><font color="#963700">false</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; IMPROVED: Main procedure with clean data format</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> log-soil-data [event-type event-details increment-value]<br />  </font><font color="#0000aa">let</font><font color="#000000"> filename </font><font color="#963700">&quot;comprehensive_soil_data.csv&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">file-open</font><font color="#000000"> filename<br /><br />  </font><font color="#5a5a5a">;; Write header only once - IMPROVED with separate increment column</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> soil-csv-header-written? [<br />    </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;tick,event_type,event_details,increment_value,soil_multiplier_mate,soil_multiplier_trees,soil_multiplier_increment,total_soil_multiplier,avg_soil_gain,avg_soil_energy,species1_contrib,species2_contrib,species3_contrib,species4_contrib,species5_contrib,species6_contrib,species7_contrib,species8_contrib,species9_contrib,total_species_contrib,num_patches&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-csv-header-written? </font><font color="#963700">true</font><font color="#000000"><br />  ]<br /><br />  </font><font color="#5a5a5a">;; Get current soil status</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> current-avg-soil-gain </font><font color="#660096">mean</font><font color="#000000"> [soil-gain] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> current-avg-soil-energy </font><font color="#660096">mean</font><font color="#000000"> [soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> current-patch-count </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;; Get species contributions (same as before)</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species1-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Toona</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species2-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Cañafístola</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species3-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Lapacho</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species4-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Petiribí</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species5-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Anchico</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species6-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Araucaria</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species7-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Guatambú</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species8-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Grevillea</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species9-contrib </font><font color="#963700">0</font><font color="#000000">  </font><font color="#5a5a5a">; Kiri</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;; Get values from individual species</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> species1-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Toona] </font><font color="#660096">of</font><font color="#000000"> species1 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> species2-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> species2 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> species3-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Lapacho] </font><font color="#660096">of</font><font color="#000000"> species3 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> species4-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Petiribí] </font><font color="#660096">of</font><font color="#000000"> species4 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> species5-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Anchico] </font><font color="#660096">of</font><font color="#000000"> species5 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> species6-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Araucaria] </font><font color="#660096">of</font><font color="#000000"> species6 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> species7-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Guatambú] </font><font color="#660096">of</font><font color="#000000"> species7 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> species8-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Grevillea] </font><font color="#660096">of</font><font color="#000000"> species8 ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> species9-contrib </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-Kiri] </font><font color="#660096">of</font><font color="#000000"> species9 ]<br /><br />  </font><font color="#5a5a5a">;; Alternative: table approach</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> table:length species-multipliers </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">1</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species1-contrib table:get species-multipliers </font><font color="#963700">1</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">2</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species2-contrib table:get species-multipliers </font><font color="#963700">2</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">3</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species3-contrib table:get species-multipliers </font><font color="#963700">3</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">4</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species4-contrib table:get species-multipliers </font><font color="#963700">4</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">5</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species5-contrib table:get species-multipliers </font><font color="#963700">5</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">6</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species6-contrib table:get species-multipliers </font><font color="#963700">6</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">7</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species7-contrib table:get species-multipliers </font><font color="#963700">7</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">8</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species8-contrib table:get species-multipliers </font><font color="#963700">8</font><font color="#000000"> ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers </font><font color="#963700">9</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> species9-contrib table:get species-multipliers </font><font color="#963700">9</font><font color="#000000"> ]<br />  ]<br /><br />  </font><font color="#5a5a5a">;; Calculate total species contribution</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> total-species-contrib (species1-contrib </font><font color="#660096">+</font><font color="#000000"> species2-contrib </font><font color="#660096">+</font><font color="#000000"> species3-contrib </font><font color="#660096">+</font><font color="#000000"><br />                            species4-contrib </font><font color="#660096">+</font><font color="#000000"> species5-contrib </font><font color="#660096">+</font><font color="#000000"> species6-contrib </font><font color="#660096">+</font><font color="#000000"><br />                            species7-contrib </font><font color="#660096">+</font><font color="#000000"> species8-contrib </font><font color="#660096">+</font><font color="#000000"> species9-contrib)<br /><br />  </font><font color="#5a5a5a">;; IMPROVED: Write data row with clean format</font><font color="#000000"><br />  </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  event-type </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  event-details </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  increment-value </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  soil-multiplier-mate </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  soil-multiplier-trees </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  soil-multiplier-increment </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  soil-multiplier </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  current-avg-soil-gain </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  current-avg-soil-energy </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species1-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species2-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species3-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species4-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species5-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species6-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species7-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species8-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  species9-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  total-species-contrib </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                  current-patch-count)<br /><br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; IMPROVED: Modified update procedures with clean logging</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-soil-multipliers-trimm [increment]<br />  </font><font color="#0000aa">let</font><font color="#000000"> old-soil-multiplier soil-multiplier<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees soil-multiplier-trees </font><font color="#660096">+</font><font color="#000000"> increment<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier (soil-multiplier </font><font color="#660096">+</font><font color="#000000"> soil-multiplier-trees)<br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-gain soil-multiplier-trees<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-energy (soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain)<br />  ]<br /><br />  </font><font color="#5a5a5a">;; IMPROVED: Clean logging with separate increment value</font><font color="#000000"><br />  log-soil-data </font><font color="#963700">&quot;trimming&quot;</font><font color="#000000"> </font><font color="#963700">&quot;tree_trimming&quot;</font><font color="#000000"> increment<br /><br />  </font><font color="#5a5a5a">;; Keep original print statements</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Old multiplier: &quot;</font><font color="#000000"> old-soil-multiplier)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil-multiplier-trees Trim-Increment: &quot;</font><font color="#000000"> increment)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;New soil-multiplier: &quot;</font><font color="#000000"> soil-multiplier)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil gain: &quot;</font><font color="#000000"> soil-multiplier-trees)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Average soil gain: &quot;</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-gain] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; IMPROVED: Modified mate harvest procedure</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-soil-multipliers-mate [increment]<br />  </font><font color="#0000aa">let</font><font color="#000000"> old-soil-multiplier soil-multiplier<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-mate soil-multiplier-mate </font><font color="#660096">+</font><font color="#000000"> increment<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier (soil-multiplier </font><font color="#660096">+</font><font color="#000000"> soil-multiplier-mate)<br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-gain soil-multiplier-mate<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-energy (soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain)<br />  ]<br /><br />  </font><font color="#5a5a5a">;; IMPROVED: Clean logging with separate increment value</font><font color="#000000"><br />  log-soil-data </font><font color="#963700">&quot;mate_harvest&quot;</font><font color="#000000"> </font><font color="#963700">&quot;harvest_event&quot;</font><font color="#000000"> increment<br /><br />  </font><font color="#5a5a5a">;; Keep original print statements</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;old-soil-multiplier: &quot;</font><font color="#000000"> old-soil-multiplier)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;new-soil-multiplier: &quot;</font><font color="#000000"> soil-multiplier)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; IMPROVED: Modified thinning procedure</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-soil-multipliers-thinning [increment species-id]<br />  </font><font color="#0000aa">let</font><font color="#000000"> old-soil-multiplier soil-multiplier<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-increment soil-multiplier-increment </font><font color="#660096">+</font><font color="#000000"> increment<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier (soil-multiplier </font><font color="#660096">+</font><font color="#000000"> soil-multiplier-increment)<br /><br />  </font><font color="#5a5a5a">;; Update species-specific contribution in table</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers species-id [<br />    </font><font color="#0000aa">let</font><font color="#000000"> current-value table:get species-multipliers species-id<br />    table:put species-multipliers species-id (current-value </font><font color="#660096">+</font><font color="#000000"> increment)<br />  ]<br />    table:put species-multipliers species-id increment<br /><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-gain soil-multiplier-increment<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-energy (soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain)<br />  ]<br /><br />  </font><font color="#5a5a5a">;; IMPROVED: Clean logging with separate increment value</font><font color="#000000"><br />  log-soil-data </font><font color="#963700">&quot;thinning&quot;</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species_&quot;</font><font color="#000000"> species-id) increment<br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Thinning species &quot;</font><font color="#000000"> species-id </font><font color="#963700">&quot; with increment: &quot;</font><font color="#000000"> increment)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;New soil multiplier: &quot;</font><font color="#000000"> soil-multiplier)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; NEW: Modified thin-tree procedure to include logging</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> thin-tree<br />  </font><font color="#0000aa">let</font><font color="#000000"> original-size </font><font color="#660096">size</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thinned-amount ( original-size </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"> )<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-increment  thinned-amount </font><font color="#660096">*</font><font color="#000000"> convert-dry </font><font color="#660096">*</font><font color="#000000"> convert-SOM<br />  </font><font color="#0000aa">set</font><font color="#000000"> thinned-count thinned-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor local-soil-factor </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">0.12</font><font color="#000000"><br />  ]<br /><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees soil-multiplier-trees </font><font color="#660096">+</font><font color="#000000"> soil-multiplier-increment<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-gain soil-multiplier-increment<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-energy ( soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain )<br /><br />  </font><font color="#5a5a5a">;; NEW: Log the individual thinning event with clean format</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; Determine species ID based on breed</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species-id </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species1 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">1</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species2 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">2</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species3 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">3</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species4 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">4</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species5 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">5</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species6 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">6</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species7 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">7</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species8 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">8</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species9 [ </font><font color="#0000aa">set</font><font color="#000000"> species-id </font><font color="#963700">9</font><font color="#000000"> ]<br /><br />  log-soil-data </font><font color="#963700">&quot;thinning&quot;</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;individual_tree_species_&quot;</font><font color="#000000"> species-id) soil-multiplier-increment<br /><br />  </font><font color="#5a5a5a">;; Keep original print statements</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;thinned-count : &quot;</font><font color="#000000"> thinned-count )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-trees Thin-Increment: &quot;</font><font color="#000000"> soil-multiplier-increment)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-trees: &quot;</font><font color="#000000"> soil-multiplier-trees)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-gain: &quot;</font><font color="#000000"> soil-gain)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-energy: &quot;</font><font color="#000000"> soil-energy)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;local-soil-factor: &quot;</font><font color="#000000"> local-soil-factor)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; NEW: Modified thinning procedures to include summary logging</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> thinning1<br />  </font><font color="#0000aa">if</font><font color="#000000"> thiniter1? [<br />    </font><font color="#0000aa">let</font><font color="#000000"> trees-before-thinning thinned-count<br />    perform-thinning [</font><font color="#963700">5</font><font color="#000000"> </font><font color="#963700">25</font><font color="#000000"> </font><font color="#963700">45</font><font color="#000000"> </font><font color="#963700">65</font><font color="#000000"> </font><font color="#963700">85</font><font color="#000000"> </font><font color="#963700">105</font><font color="#000000"> </font><font color="#963700">125</font><font color="#000000"> </font><font color="#963700">145</font><font color="#000000"> </font><font color="#963700">165</font><font color="#000000"> </font><font color="#963700">185</font><font color="#000000"> </font><font color="#963700">205</font><font color="#000000">]<br />    </font><font color="#0000aa">let</font><font color="#000000"> trees-thinned (thinned-count </font><font color="#660096">-</font><font color="#000000"> trees-before-thinning)<br /><br />    </font><font color="#5a5a5a">;; Log the thinning event summary</font><font color="#000000"><br />    log-soil-data </font><font color="#963700">&quot;thinning_event&quot;</font><font color="#000000"> </font><font color="#963700">&quot;thinning1_complete&quot;</font><font color="#000000"> trees-thinned<br /><br />    </font><font color="#0000aa">set</font><font color="#000000"> countert1 </font><font color="#660096">ticks</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thinned-count </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter1? </font><font color="#963700">false</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter2? </font><font color="#963700">true</font><font color="#000000"><br /><br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Thinning1 completed at tick &quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot; - &quot;</font><font color="#000000"> trees-thinned </font><font color="#963700">&quot; trees thinned&quot;</font><font color="#000000">)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> thinning2<br />  </font><font color="#0000aa">if</font><font color="#000000"> thiniter2? [<br />    </font><font color="#0000aa">let</font><font color="#000000"> trees-before-thinning thinned-count<br />    perform-thinning [</font><font color="#963700">15</font><font color="#000000"> </font><font color="#963700">35</font><font color="#000000"> </font><font color="#963700">55</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000"> </font><font color="#963700">95</font><font color="#000000"> </font><font color="#963700">115</font><font color="#000000"> </font><font color="#963700">135</font><font color="#000000"> </font><font color="#963700">155</font><font color="#000000"> </font><font color="#963700">175</font><font color="#000000"> </font><font color="#963700">195</font><font color="#000000"> </font><font color="#963700">215</font><font color="#000000">]<br />    </font><font color="#0000aa">let</font><font color="#000000"> trees-thinned (thinned-count </font><font color="#660096">-</font><font color="#000000"> trees-before-thinning)<br /><br />    </font><font color="#5a5a5a">;; Log the thinning event summary</font><font color="#000000"><br />    log-soil-data </font><font color="#963700">&quot;thinning_event&quot;</font><font color="#000000"> </font><font color="#963700">&quot;thinning2_complete&quot;</font><font color="#000000"> trees-thinned<br /><br />    </font><font color="#0000aa">set</font><font color="#000000"> thinned-count </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter1? </font><font color="#963700">true</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter2? </font><font color="#963700">false</font><font color="#000000"><br /><br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Thinning2 completed at tick &quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot; - &quot;</font><font color="#000000"> trees-thinned </font><font color="#963700">&quot; trees thinned&quot;</font><font color="#000000">)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; IMPROVED: General procedure for any soil event with clean format</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> log-general-soil-event [event-name details increment-val]<br />  log-soil-data event-name details increment-val<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; IMPROVED: Enhanced reporting procedures with clean logging</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> soil-multiplier-sources<br />  </font><font color="#0000aa">let</font><font color="#000000"> report-string </font><font color="#963700">&quot;&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> report-string (</font><font color="#660096">word</font><font color="#000000"> report-string<br />    </font><font color="#963700">&quot;Harvest contributions: &quot;</font><font color="#000000"> soil-multiplier-mate </font><font color="#963700">&quot;\n&quot;</font><font color="#000000"><br />    </font><font color="#963700">&quot;Tree contributions: &quot;</font><font color="#000000"> soil-multiplier-trees </font><font color="#963700">&quot;\n&quot;</font><font color="#000000"><br />    </font><font color="#963700">&quot;Thinning contributions: &quot;</font><font color="#000000"> soil-multiplier-increment </font><font color="#963700">&quot;\n&quot;</font><font color="#000000">)<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> table:length species-multipliers </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> report-string (</font><font color="#660096">word</font><font color="#000000"> report-string<br />      </font><font color="#963700">&quot;Table total: &quot;</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> table:values species-multipliers </font><font color="#963700">&quot;\n&quot;</font><font color="#000000">)<br />  ]<br /><br />  </font><font color="#0000aa">set</font><font color="#000000"> report-string (</font><font color="#660096">word</font><font color="#000000"> report-string<br />    </font><font color="#963700">&quot;Current total multiplier: &quot;</font><font color="#000000"> soil-multiplier </font><font color="#963700">&quot;\n&quot;</font><font color="#000000"><br />    </font><font color="#963700">&quot;Average soil gain: &quot;</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-gain] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">)<br /><br />  </font><font color="#5a5a5a">;; IMPROVED: Clean logging for status check</font><font color="#000000"><br />  log-soil-data </font><font color="#963700">&quot;status_check&quot;</font><font color="#000000"> </font><font color="#963700">&quot;soil_multiplier_sources_called&quot;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br /><br />  </font><font color="#0000aa">report</font><font color="#000000"> report-string<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> species-contributions<br />  </font><font color="#0000aa">let</font><font color="#000000"> report-string </font><font color="#963700">&quot;&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species-names [</font><font color="#963700">&quot;Toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Cañafístola&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Lapacho&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Petiribí&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Anchico&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Araucaria&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Guatambú&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Grevillea&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Kiri&quot;</font><font color="#000000">]<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> species-names [ species-name -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> contribution </font><font color="#963700">0</font><font color="#000000"><br /><br />    </font><font color="#0000aa">if</font><font color="#000000"> table:has-key? species-multipliers i [<br />      </font><font color="#0000aa">set</font><font color="#000000"> contribution table:get species-multipliers i<br />    ]<br /><br />    </font><font color="#0000aa">set</font><font color="#000000"> report-string (</font><font color="#660096">word</font><font color="#000000"> report-string species-name </font><font color="#963700">&quot;: &quot;</font><font color="#000000"> contribution </font><font color="#963700">&quot;\n&quot;</font><font color="#000000">)<br />    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  ]<br /><br />  </font><font color="#5a5a5a">;; IMPROVED: Clean logging for status check</font><font color="#000000"><br />  log-soil-data </font><font color="#963700">&quot;status_check&quot;</font><font color="#000000"> </font><font color="#963700">&quot;species_contributions_called&quot;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br /><br />  </font><font color="#0000aa">report</font><font color="#000000"> report-string<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> die-ilex<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> minimum-viable-size [</font><font color="#0000aa">die</font><font color="#000000">]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> die-tree<br /></font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> minimum-viable-size [</font><font color="#0000aa">die</font><font color="#000000">]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> current-soil-gain<br />  </font><font color="#0000aa">report</font><font color="#000000"> soil-gain<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> current-soil-energy<br />  </font><font color="#0000aa">report</font><font color="#000000"> soil-energy<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> current-energy-plants<br />  </font><font color="#0000aa">report</font><font color="#000000">  </font><font color="#660096">mean</font><font color="#000000"> [ et ] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-multiplier-mate<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-multiplier-mate] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-multiplier-trees<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-multiplier-trees] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-multiplier<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> cumulative-thinning-effect<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-trees] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> thinning-biomass-removed<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [thinned-amount] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-biomass-removed<br />  </font><font color="#0000aa">report</font><font color="#000000"> total-harvest </font><font color="#660096">+</font><font color="#000000"><br />         </font><font color="#660096">sum</font><font color="#000000"> [harvest-trees] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> species0]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> external-reposition<br />  </font><font color="#0000aa">report</font><font color="#000000"> fertilizer-amount<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> fertilizer-harvest-ratio<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> total-harvest </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">report</font><font color="#000000"> fertilizer-amount </font><font color="#660096">/</font><font color="#000000"> total-harvest<br />  ] [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-gain<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-gain] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-energy<br />  </font><font color="#0000aa">report</font><font color="#000000">  </font><font color="#660096">mean</font><font color="#000000"> [ soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil<br />  </font><font color="#0000aa">report</font><font color="#000000">  </font><font color="#660096">mean</font><font color="#000000"> [ soil] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> patches-soil-factor<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [local-soil-factor] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-energy-ilex<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-ilex] </font><font color="#660096">of</font><font color="#000000"> species0<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> avg-energy-ilex<br />  </font><font color="#0000aa">report</font><font color="#000000"> total-energy-ilex </font><font color="#660096">/</font><font color="#000000"> Ni<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-energy-trees<br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">sum</font><font color="#000000"> [energy-Toona] </font><font color="#660096">of</font><font color="#000000"> species1 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> species2 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Lapacho] </font><font color="#660096">of</font><font color="#000000"> species3 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Petiribí] </font><font color="#660096">of</font><font color="#000000"> species4 </font><font color="#660096">+</font><font color="#000000"><br />    </font><font color="#660096">sum</font><font color="#000000"> [energy-Anchico] </font><font color="#660096">of</font><font color="#000000"> species5 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Araucaria] </font><font color="#660096">of</font><font color="#000000"> species6 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Guatambú] </font><font color="#660096">of</font><font color="#000000"> species7 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Grevillea] </font><font color="#660096">of</font><font color="#000000"> species8 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Kiri] </font><font color="#660096">of</font><font color="#000000"> species9 )<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> avg-energy-trees<br />  </font><font color="#0000aa">report</font><font color="#000000"> total-energy-trees </font><font color="#660096">/</font><font color="#000000"> Nt<br /></font><font color="#007f69">end</font>
</pre>
